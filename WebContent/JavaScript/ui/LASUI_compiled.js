function LASUI(){this.refs={plot:{},DW:{widgetType:null},DepthWidget:{widgetType:null},analysis:{enabled:false},options:{plot:{},download:{},external:{}},operations:{plot:{},download:{},external:{}}};this.hrefs={getProduct:{url:"ProductServer.do"},getCategories:{url:"getCategories.do"},getDataConstraints:{url:"getDataConstraints.do"},getGrid:{url:"getGrid.do"},getViews:{url:"getViews.do"},getOperations:{url:"getOperations.do"},getOptions:{url:"getOptions.do"},getMetadata:{url:"getMetadata.do"}};this.state=
{dataset:null,datasets:{},operation:{plot:null,download:null,external:null},properties:{plot:[],download:[],external:[]},optiondefs:{plot:"",download:"",external:""},newproperties:{plot:[],download:[],external:[]},view:{plot:null,download:null,external:null,widgets:null},embed:true,xybox:{},categorynames:[],analysis:{type:null,axes:{}},selection:{x:{},y:{},z:{},t:{}}};this.anchors={tree:"tree",output:"output",map:"MapWidget",date:"date",depth:"depth",header:"header",breadcrumb:"breadcrumb",variables:"variables",
inputs:{maxX:"input_maxX",maxY:"input_maxY",minX:"input_minX",minY:"input_minY"},analysis:"analysis"};this.AJAX_cache={};this.request=new LASRequest;this.autoupdate=false;for(var f in this)if(typeof this[f]=="function")this[f].LASBind=function(object){var __method=this;var args=[];for(var i=0,length=arguments.length;i<length;i++)args.push(arguments[i]);var object=args.shift();return function(event){return __method.apply(object,[event||window.event].concat(args))}}}
LASUI.prototype.initUI=function(anchorId){if((this.params.dsid||this.params.catid)&&this.params.varid){this.state.dataset=this.params.dsid;this.state.catid=this.params.catid;this.state.lastDataset="";this.state.lastVariable="";this.state.variable=this.params.varid;this.state.operation.plot=this.params.plot;this.state.view.plot=this.params.view;this.autoupdate=this.params.autoupdate;if((this.state.dataset!=""||this.params.catid!="")&&this.state.variable!=""){this.submitOnLoad=true;document.getElementById("ol_map_widget").onmouseover=
null}else this.submitOnLoad=false}else this.submitOnLoad=false;this.state.xybox={};this.fullXYExtent=true;this.UIMask=document.createElement("DIV");this.UIMask.className="LASUIMask";this.toggleUIMask("none");document.body.appendChild(this.UIMask);this.firstload=true;this.expired=false;this.refs.operations.plot.DOMNode=document.getElementById("plotType");this.refs.operations.download.DOMNode=document.getElementById("downloadType");this.refs.options.plot.DOMNode=document.getElementById("plotOptions");
this.refs.options.download.DOMNode=document.getElementById("downloadOptions");this.refs.options.external.DOMNode=document.getElementById("externalOptions");this.refs.analysis.type={op:document.getElementById("analysis_op"),axes:document.getElementById("analysis_axes")};this.refs.analysis.axes={xy:document.getElementById("xy_analysis"),x:document.getElementById("x_analysis"),y:document.getElementById("y_analysis"),z:document.getElementById("z_analysis"),t:document.getElementById("t_analysis")};this.refs.analysis.type.axes.onchange=
this.selectAnalysisAxis.LASBind(this,null,true);this.refs.analysis.type.op.onchange=this.selectAnalysisType.LASBind(this);if(document.getElementById(this.anchors.output).addEventListener&&!document.all)document.getElementById(this.anchors.output).addEventListener("load",this.onPlotLoad.LASBind(this),true);else if(document.getElementById(this.anchors.output).attachEvent&&!document.all)document.getElementById(this.anchors.output).addEventListener("load",this.onPlotLoad.LASBind(this));else if(document.all)document.getElementById(this.anchors.output).onreadystatechange=
this.onPlotLoad.LASBind(this);else document.getElementById(this.anchors.output).onload=this.onPlotLoad.LASBind(this);this.refs.inputs={};for(var i in this.anchors.inputs)this.refs.inputs[i]=document.getElementById(this.anchors.inputs[i]);if(document.getElementById("categories")){this.refs.categories={};this.refs.categories.LINode=document.getElementById("categories");var cancel=document.createElement("INPUT");cancel.type="submit";cancel.value="Close";cancel.className="LASSubmitInputNode";cancel.onclick=
this.genericHandler.LASBind(this,"this.hideCategories()");this.refs.categories.LINode.appendChild(cancel);this.refs.categories.LINode.appendChild(document.createElement("BR"));this.refs.categories.title=document.createElement("SPAN");this.refs.categories.title.appendChild(document.createTextNode("Select a dataset category."));this.refs.categories.title.className="LASTreeTitleNode";this.refs.categories.ULNode=document.createElement("UL");this.refs.categories.ULNode.className="LASTreeULNode";this.refs.categories.LINode.appendChild(this.refs.categories.title);
this.refs.categories.LINode.appendChild(this.refs.categories.ULNode);this.refs.categories.isExpanded=true;if(!document.all)var req=new XMLHttpRequest(this);else var req=new ActiveXObject("Microsoft.XMLHTTP");req.onreadystatechange=this.AJAXhandler.LASBind(this,req,"this.AJAX_cache['"+escape(this.hrefs.getCategories.url)+"']=req.responseText;this.setCategoryTreeNode(req.responseText,this.refs.categories,'categories');");this.AJAX_cache[this.hrefs.getCategories.url]="waiting";req.open("GET",this.hrefs.getCategories.url);
req.send(null)}if((this.state.dataset!=""||this.params.catid!="")&&this.state.variable!=""){if(this.params.catid)var catid=this.params.catid;else var catid=this.state.dataset;if(!document.all)var req=new XMLHttpRequest(this);else var req=new ActiveXObject("Microsoft.XMLHTTP");req.onreadystatechange=this.AJAXhandler.LASBind(this,req,"this.setInitialVariable(req.responseText);");req.open("GET",this.hrefs.getCategories.url+"?catid="+catid);req.send(null)}};
LASUI.prototype.setInitialVariable=function(strJson){var response=eval("("+strJson+")");if(response.categories)if(response.categories.status)if(response.categories.status=="ok"){var category=new LASGetCategoriesResponse(response);this.state.dataset=category.getDatasetID(0);this.state.datasets[this.state.dataset]=category;this.getGrid(this.state.dataset,this.state.variable);this.getDataConstraints(this.state.dataset,this.state.variable);var info=document.createElement("IMG");info.onclick=this.getMetadata.LASBind(this);
info.src="images/icon_info.gif";var varlist=document.createElement("SELECT");varlist.id="variables";if(document.getElementById(this.anchors.breadcrumb)){while(document.getElementById(this.anchors.breadcrumb).firstChild)document.getElementById(this.anchors.breadcrumb).removeChild(document.getElementById(this.anchors.breadcrumb).firstChild);document.getElementById(this.anchors.breadcrumb).appendChild(info);document.getElementById(this.anchors.breadcrumb).appendChild(document.createTextNode(category.getDatasetName()));
document.getElementById(this.anchors.breadcrumb).appendChild(varlist)}document.getElementById(this.anchors.variables).onchange=function(evt){this.options[this.selectedIndex].onselect({target:{selected:true}})};for(var i=0;i<category.getCategorySize();i++){if(this.state.variable==category.getChildID(i))var selected=true;else var selected=false;var OPTIONNode=new Option(category.getChildName(i),category.getChildID(i),false,selected);OPTIONNode.onselect=this.setVariable.LASBind(this,{category:category},
i,true);OPTIONNode.id="OPTION_"+category.getChildID(i);document.getElementById(this.anchors.variables).options[document.getElementById(this.anchors.variables).length]=OPTIONNode}var varObj=this.state.datasets[this.state.dataset].getChildByID(this.state.variable);if(varObj)if(varObj.grid_type!="scattered"){if(this.refs.analysis.enabled){this.hideAnalysis();this.showAnalysis()}document.getElementById("analysisWrapper").style.display=""}else{document.getElementById("analysisWrapper").style.display="none";
this.refs.analysis.enabled=false}}};LASUI.prototype.getMetadata=function(evt){window.open(this.hrefs.getMetadata.url+"?dsid="+this.state.dataset)};LASUI.prototype.hideCategories=function(){this.refs.categories.LINode.style.display="none";this.toggleUIMask("none")};LASUI.prototype.toggleUIMask=function(display){this.UIMask.style.height=document.body.offsetHeight+100+"px";this.UIMask.style.width=document.body.offsetWidth+30+"px";this.UIMask.style.display=display};
LASUI.prototype.AJAXhandler=function(app){var args=arguments;var req=args[1];var callback=args[2];if(req.readyState==4&&req.status==200)eval(callback)};LASUI.prototype.setCategoryTreeNode=function(strJson,node,id){var response=eval("("+strJson+")");node.category=new LASGetCategoriesResponse(response);if(node.category.getCategoryType()=="category")node.children=[];for(var i=0;i<node.category.getCategorySize();i++)this.setCategoryTreeSubNode(node,i,id);this.expand(node)};
LASUI.prototype.showInfo=function(evt){var args=arguments;var node=args[1];var i=args[2];if(node.category)if(node.category.getChildID(i))if(node.category.getChildChildrenType(i)=="variables")window.open(this.hrefs.getMetadata.url+"?dsid="+node.category.getChildID(i));else window.open(this.hrefs.getMetadata.url+"?catid="+node.category.getChildID(i))};
LASUI.prototype.setCategoryTreeSubNode=function(node,i,id){switch(node.category.getCategoryType()){case "category":this.createCategoryTreeNode(node,i,id);break;case "dataset":this.createVariableTreeNode(node,i);break}};
LASUI.prototype.createCategoryTreeNode=function(node,i,id){if(node==this.refs.categories&&node.category.getChildChildrenType(i)=="variables")this.refs.categories.title.innerHTML="Datasets";node.children[i]={};node.children[i].LINode=document.createElement("LI");node.children[i].LINode.className="LASTreeLINode";node.children[i].IMGNode=document.createElement("IMG");node.children[i].IMGNode.onclick=this.selectCategory.LASBind(this,node,i);node.children[i].IMGNode.src="JavaScript/ui/plus.gif";node.children[i].IMGNode.className=
"LASCategoryIMGNode";node.children[i].isExpanded=false;node.children[i].ULNode=document.createElement("ul");var table=document.createElement("TABLE");table.className="LASTreeTableNode";table.width="100%";var tbody=document.createElement("TBODY");tbody.style.padding=0;tbody.style.margin=0;var tr=document.createElement("TR");tr.style.padding=0;tr.style.margin=0;var td1=document.createElement("TD");td1.style.verticalAlign="top";td1.width="12px";td1.appendChild(node.children[i].IMGNode);td1.className=
"LASTreeTableCell";var td2=document.createElement("TD");td2.style.verticalAlign="top";td2.onclick=this.selectCategory.LASBind(this,node,i);td2.appendChild(document.createTextNode(node.category.getChildName(i)));td2.className="LASTreeTableCell";td2.style.textAlign="left";tr.appendChild(td1);tr.appendChild(td2);if(node.category.getChildChildrenType(i)=="variables"){var td3=document.createElement("TD");node.children[i].A=document.createElement("A");var img=document.createElement("img");img.src="images/icon_info.gif";
node.children[i].A.appendChild(img);node.children[i].A.onclick=this.showInfo.LASBind(this,node,i);td3.appendChild(node.children[i].A);td3.className="LASTreeTableCell";td3.width="12pt";tr.appendChild(td3)}tbody.appendChild(tr);table.appendChild(tbody);node.children[i].LINode.appendChild(table);node.children[i].LINode.appendChild(node.children[i].ULNode);if(node.category.getChildChildrenType(i)=="variables"&&node.category.getChild(i).children_dsid||node.category.getChildChildrenType(i)!="variables")node.ULNode.appendChild(node.children[i].LINode);
if(this.refs.categories[node.category.getChild(i).ID]||node.category.getChild(i).ID==this.state.dataset)this.selectCategory(null,node,i)};
LASUI.prototype.createVariableOptionNode=function(node,i){document.getElementById(this.anchors.variables).onchange=function(evt){this.options[this.selectedIndex].onselect({target:{selected:true}})};if(this.state.variable==node.category.getChildID(i))var selected=true;else var selected=false;var OPTIONNode=new Option(node.category.getChildName(i),node.category.getChildID(i),false,selected);OPTIONNode.onselect=this.setVariable.LASBind(this,node,i,true);OPTIONNode.id="OPTION_"+node.category.getChildID(i);
document.getElementById(this.anchors.variables).options[document.getElementById(this.anchors.variables).length]=OPTIONNode};
LASUI.prototype.createVariableTreeNode=function(node,i){if(!node.children)node.children=[];if(!node.children[i])node.children[i]={};node.children[i].LINode=document.createElement("LI");node.children[i].LINode.style.listStyleType="none";node.children[i].LINode.style.listStyleImage="none";node.children[i].LINode.className="LASTreeLINode";node.marginLeft="5pt";if(document.all){var elem_nm="<INPUT NAME='"+node.category.getDatasetID(i)+"'>";node.children[i].INPUTNode=document.createElement(elem_nm)}else{node.children[i].INPUTNode=
document.createElement("INPUT");node.children[i].INPUTNode.name=node.category.getDatasetID(i)}node.children[i].INPUTNode.type="radio";node.children[i].className="LASRadioInputNode";node.children[i].INPUTNode.onclick=this.setVariable.LASBind(this,node,i);node.children[i].INPUTNode.id=node.category.getChildID(i);var table=document.createElement("TABLE");table.width="100%";var tbody=document.createElement("TBODY");var tr=document.createElement("TR");var td1=document.createElement("TD");td1.appendChild(node.children[i].INPUTNode);
td1.className="LASTreeTableCell";td1.width="12pt";var td2=document.createElement("TD");td2.innerHTML=node.category.getChildName(i);td2.align="left";td2.className="LASTreeTableCell";tr.appendChild(td1);tr.appendChild(td2);tbody.appendChild(tr);table.appendChild(tbody);node.children[i].LINode.appendChild(table);if(this.state.variable==node.category.getChildID(i))node.children[i].INPUTNode.checked=true;node.ULNode.appendChild(node.children[i].LINode)};
LASUI.prototype.getCategory=function(parentNode,i){if(!parentNode.children[i].category){if(!document.all)var req=new XMLHttpRequest(this);else var req=new ActiveXObject("Microsoft.XMLHTTP");req.onreadystatechange=this.AJAXhandler.LASBind(this,req,"this.setCategoryTreeNode(req.responseText,args[3].children[args[4]],args[3].category.getChild(args[4]));",parentNode,i);req.open("GET",this.hrefs.getCategories.url+"?catid="+parentNode.category.getChildID(i));req.send(null)}};
LASUI.prototype.onSetVariable=function(){document.getElementById("constraints").style.visibility="visible";if(document.getElementById("categories"))document.getElementById("categories").style.display="none";this.toggleUIMask("none");if(this.state.categorynames)if(this.state.categorynames.length>0){var categories=this.state.categorynames[0];for(var i=1;i<this.state.categorynames.length;i++)categories+=" / "+this.state.categorynames[i]}else var categories=this.state.datasets[this.state.dataset].getDatasetName();
var info=document.createElement("IMG");info.onclick=this.getMetadata.LASBind(this);info.src="images/icon_info.gif";var varlist=document.createElement("SELECT");varlist.id="variables";var cats=document.createElement("TEXT");cats.innerHTML=categories;if(document.getElementById(this.anchors.breadcrumb)){while(document.getElementById(this.anchors.breadcrumb).firstChild)document.getElementById(this.anchors.breadcrumb).removeChild(document.getElementById(this.anchors.breadcrumb).firstChild);document.getElementById(this.anchors.breadcrumb).appendChild(info);
document.getElementById(this.anchors.breadcrumb).appendChild(cats);document.getElementById(this.anchors.breadcrumb).appendChild(varlist)}for(var i=0;i<this.state.datasets[this.state.dataset].getCategorySize();i++)this.createVariableOptionNode({category:this.state.datasets[this.state.dataset]},i);var varObj=this.state.datasets[this.state.dataset].getChildByID(this.state.variable);if(varObj){if(varObj.grid_type!="scattered"){if(this.refs.analysis.enabled){this.hideAnalysis();this.showAnalysis()}document.getElementById("analysisWrapper").style.display=
""}else{document.getElementById("analysisWrapper").style.display="none";this.refs.analysis.enabled=false}if(document.getElementById("V6"))document.getElementById("V6").href="servlets/datasets?dset="+this.urlencode(categories+"/"+varObj.name)}document.getElementById("ol_map_widget").onmouseover=null};
LASUI.prototype.selectCategory=function(evt){var args=arguments;var parentNode=args[1];var i=args[2];if(!parentNode.children[i].isExpanded){if(parentNode==this.refs.categories){this.state.categories={};this.state.categories[parentNode.category.getChild(i).ID]={}}for(var c=0;c<parentNode.children.length;c++){this.collapse(parentNode.children[c]);for(var b=0;b<this.state.categorynames.length;b++)if(this.state.categorynames[b]==parentNode.category.getChildName(c))this.state.categorynames.splice(b,this.state.categorynames.length-
b)}this.expand(parentNode.children[i]);if(parentNode==this.refs.categories)this.state.categorynames=[];this.state.categorynames.push(parentNode.category.getChildName(i))}else{this.collapse(parentNode.children[i]);for(var c=0;c<this.state.categorynames.length;c++)if(this.state.categorynames[c]==parentNode.category.getChildName(i))this.state.categorynames.splice(c,this.state.categorynames.length-c)}if(!parentNode.children[i].category){parentNode.children[i].IMGNode.src="JavaScript/components/mozilla_blu.gif";
if(!document.all)var req=new XMLHttpRequest(this);else var req=new ActiveXObject("Microsoft.XMLHTTP");req.onreadystatechange=this.AJAXhandler.LASBind(this,req,"this.setCategoryTreeNode(req.responseText,args[3].children[args[4]],args[3].category.getChild(args[4]));",parentNode,i);req.open("GET",this.hrefs.getCategories.url+"?catid="+parentNode.category.getChildID(i));req.send(null);this.state.catid=parentNode.category.getChildID(i)}};
LASUI.prototype.setVariable=function(evt){var args=arguments;var dataset=args[1];var i=args[2];var datasetID=dataset.category.getDatasetID(i);var variableID=dataset.category.getChildID(i);var variable=dataset.category.getChild(i);this.state.datasets[datasetID]=dataset.category;this.state.lastDataset=this.state.dataset;this.state.dataset=datasetID;this.state.variable=variableID;this.getGrid(datasetID,variableID);this.getDataConstraints(datasetID,variableID);this.newVariable=true;if(this.onSetVariable)this.onSetVariable()};
LASUI.prototype.setDataset=function(dataset){this.state.dataset=dataset;this.state.newgrid=true;if(this.state.datasets[this.state.dataset].getChildByID(this.state.variable))this.getGrid(dataset,this.state.variable);if(this.onSetDataset)this.onSetDataset()};
LASUI.prototype.getDataConstraints=function(dataset,variable){if(!document.all)var req=new XMLHttpRequest(this);else var req=new ActiveXObject("Microsoft.XMLHTTP");req.onreadystatechange=this.AJAXhandler.LASBind(this,req,"this.setDataConstraints(req.responseText);");req.open("GET",this.hrefs.getDataConstraints.url+"?dsid="+dataset+"&varid="+variable);req.send(null)};
LASUI.prototype.setDataConstraints=function(strJson){if(strJson){var response=eval("("+strJson+")");if(!this.state.constraints)this.state.constraints={};this.state.lastconstraints=this.state.constraints;this.state.constraints=response.constraints}if(this.state.lastconstraints!=this.state.constraints){document.getElementById("DataConstraints").innerHTML="";document.getElementById("DataConstraints").style.display="";if(this.state.constraints.constraint){this.refs.constraints=[];for(var c=0;c<this.state.constraints.constraint.length;c++){var constraint=
{};var DIVNode=document.createElement("DIV");constraint.apply=document.createElement("INPUT");constraint.apply.type="checkbox";DIVNode.appendChild(constraint.apply);if(this.state.constraints.constraint[c].constraint.menu.content){var temp=this.state.constraints.constraint[c].constraint.menu;this.state.constraints.constraint[c].constraint.menu=[];this.state.constraints.constraint[c].constraint.menu[0]=temp}for(var m=0;m<this.state.constraints.constraint[c].constraint.menu.length;m++){eval("constraint."+
this.state.constraints.constraint[c].constraint.menu[m].position+' = document.createElement("SELECT")');if(this.state.constraints.constraint[c].constraint.menu[m].item.content){var temp=this.state.constraints.constraint[c].constraint.menu[m].item;this.state.constraints.constraint[c].constraint.menu[m].item=[];this.state.constraints.constraint[c].constraint.menu[m].item[0]=temp}for(var i=0;i<this.state.constraints.constraint[c].constraint.menu[m].item.length;i++){var option=document.createElement("option");
option.value=this.state.constraints.constraint[c].constraint.menu[m].item[i].values;option.appendChild(document.createTextNode(this.state.constraints.constraint[c].constraint.menu[m].item[i].content));eval("constraint."+this.state.constraints.constraint[c].constraint.menu[m].position+".appendChild(option)")}}if(constraint.lhs)DIVNode.appendChild(constraint.lhs);if(constraint.ops)DIVNode.appendChild(constraint.ops);if(constraint.rhs)DIVNode.appendChild(constraint.rhs);else{constraint.rhs=document.createElement("INPUT");
constraint.rhs.type="text";DIVNode.appendChild(constraint.rhs)}constraint.type=this.state.constraints.constraint[c].constraint.type;document.getElementById("DataConstraints").appendChild(DIVNode);this.refs.constraints.push(constraint)}}}};
LASUI.prototype.getOperations=function(dataset,variable,view){if(!document.all)var req=new XMLHttpRequest(this);else var req=new ActiveXObject("Microsoft.XMLHTTP");var url=this.hrefs.getOperations.url+"?dsid="+dataset+"&varid="+variable+"&view="+view;if(view)if(!this.AJAX_cache[url]){this.AJAX_cache[url]="waiting";req.onreadystatechange=this.AJAXhandler.LASBind(this,req,"this.AJAX_cache['"+url+"'] = req.responseText; this.setOperationList(req.responseText);");req.open("GET",url);req.send(null)}else if(this.AJAX_cache[url]!=
"waiting")this.setOperationList(this.AJAX_cache[url])};LASUI.prototype.setDownloadOperation=function(evt){var args=arguments;var id=args[1];var optiondef=args[2];this.state.operation.download=id;this.state.optiondefs.download=optiondef;var view=args[2];var optiondef=args[3];this.state.view.download=this.state.view.plot};
LASUI.prototype.doDownload=function(){if(!this.state.operation.download||this.refs.operations.download.SELECTNode.selectedIndex==0){alert("Please choose a file format to download.");return}if(document.getElementById("OPTION_DOWNLOAD_"+this.state.operation.download).disabled){alert("The "+document.getElementById("OPTION_DOWNLOAD_"+this.state.operation.download).innerHTML+" download format is not compatible with the current plot view. Please choose another plot view, or another download format.");return}if(this.state.optiondefs.download!=
""){this.toggleUIMask("");this.refs.options.download.DOMNode.style.display="";this.getOptions(this.state.optiondefs.download,"download",true)}else this.makeRequest({},"download")};
LASUI.prototype.setOperation=function(evt){var args=arguments;var id=args[1];var optiondef=args[3];var type=args[4];if(!type)type="plot";if(type=="plot")try{if(this.state.operations)if(this.state.operations.getOperationByID(id).optiondef.IDREF)optiondef=this.state.operations.getOperationByID(id).optiondef.IDREF}catch(e){}if(type=="plot"&&document.all&&evt.srcElement){for(var t in this.refs.operations.plot.children)if(this.refs.operations.plot.children[t].radio)this.refs.operations.plot.children[t].radio.checked=
false;evt.srcElement.checked=true}this.state.operation[type]=id;this.refs.options[type].DOMNode.innerHTML="";var view=args[2];this.state.view[type]=view;if(this.refs.analysis.enabled)for(var a in this.state.analysis.axes)if(view.indexOf(a)<0){view+=a;this.refs.analysis.axes[a].selected=true}else{this.refs.analysis.axes[a].selected=false;if(a=="x"||a=="y")this.refs.analysis.axes["xy"].selected=false;delete this.state.analysis.axes[a]}this.state.view.widgets=view;this.updateConstraints(view);this.state.lastVariable=
this.state.variable;this.state.lastDataset=this.state.dataset;if(type=="plot"&&this.state.operation.plot=="init")this.getOperations(this.state.dataset,this.state.variable,this.state.view.plot);if(optiondef)this.getOptions(optiondef,"plot",false)};LASUI.prototype.genericHandler=function(evt){if(arguments[1])eval(arguments[1])};
LASUI.prototype.setOperationList=function(strJson){var response=eval("("+strJson+")");var setDefault=true;this.state.operations=new LASGetOperationsResponse(response);for(var row=0;row<document.getElementById("productButtons").childNodes.length;row++)for(var cell=0;cell<document.getElementById("productButtons").childNodes[row].childNodes.length;cell++)try{document.getElementById("productButtons").childNodes[row].style.visibility="hidden"}catch(e){}for(var o in this.refs.operations.download.children)this.refs.operations.download.children[o].OPTIONNode.disabled=
true;for(var row=0;row<document.getElementById("productButtons").childNodes.length;row++)var setDefaultVis=true;if(!this.state.operations.response.operations.error)for(var i=0;i<this.state.operations.getOperationCount();i++){this.setOperationNode(this.state.operations.getOperationID(i),this.state.operations.getOperationName(i));if(this.state.operations.getOperation(i).category=="visualization")if(this.state.operations.getOperation(i)["default"]=="true"){this.state.operation.plot=this.state.operations.getOperationID(i);
setDefaultVis=false}else var defaultVis=this.state.operations.getOperationID(i)}if(setDefaultVis==true&&defaultVis)this.state.operation.plot=defaultVis;this.getOptions(this.state.operations.getOperationByID(this.state.operation.plot).optiondef.IDREF,"plot",true);if(this.refs.analysis.enabled||!this.state.grid.hasAxis("t"))document.getElementById("Animation").style.visibility="hidden"};
LASUI.prototype.setOperationNode=function(id,name){var button=document.getElementById(name);if(button){button.style.visibility="visible";button.onclick=this.doProductIconClick.LASBind(this,id)}var option=document.getElementById("OPTION_DOWNLOAD_"+id);if(option)option.disabled=""};
LASUI.prototype.doProductIconClick=function(evt){var args=arguments;var id=args[1];this.state.operation.external=id;this.state.view.external=this.state.view.plot;this.toggleUIMask("");if(this.state.operations.getOperationByID(id))if(this.state.operations.getOperationByID(id).optiondef){this.getOptions(this.state.operations.getOperationByID(id).optiondef.IDREF,"external",true);this.refs.options.external.DOMNode.style.display=""}else{this.refs.options.external.DOMNode.style.display="none";this.toggleUIMask("none");
this.makeRequest({},"external");return}};
LASUI.prototype.getGrid=function(dataset,variable){var url=this.hrefs.getGrid.url+"?dsid="+dataset+"&varid="+variable;if(!this.AJAX_cache[url]){this.AJAX_cache[url]="waiting";if(!document.all)var req=new XMLHttpRequest(this);else var req=new ActiveXObject("Microsoft.XMLHTTP");req.onreadystatechange=this.AJAXhandler.LASBind(this,req,"this.AJAX_cache['"+url+"']=req.responseText;this.setGrid(req.responseText);");req.open("GET",this.hrefs.getGrid.url+"?dsid="+dataset+"&varid="+variable);req.send(null)}else if(this.AJAX_cache[url]!=
"waiting")this.setGrid(AJAX_cache[url])};LASUI.prototype.setGrid=function(strJson){if(strJson==""){alert("This dataset is currently unavailable.");return-1}eval("var response = ("+strJson+")");if(this.state.grid)this.state.lastgrid=this.clone(this.state.grid);this.state.grid=new LASGetGridResponse(response);if(!this.state.lastgrid)this.state.lastgrid=this.clone(this.state.grid);this.getViews(this.state.dataset,this.state.variable)};
LASUI.prototype.getViews=function(dataset,variable){var url=this.hrefs.getViews.url+"?dsid="+dataset+"&varid="+variable;if(!this.AJAX_cache[url]){this.AJAX_cache[url]="waiting";if(!document.all)var req=new XMLHttpRequest(this);else var req=new ActiveXObject("Microsoft.XMLHTTP");req.onreadystatechange=this.AJAXhandler.LASBind(this,req,"this.AJAX_cache['"+url+"']=req.responseText;this.setViews(req.responseText);");req.open("GET",url);req.send(null)}if(this.AJAX_cache[url]!="waiting")this.setViews(this.AJAX_cache[url])};
LASUI.prototype.setViews=function(strJson){var response=eval("("+strJson+")");if(!this.refs.views)this.refs.views={};this.refs.views.views=new LASGetViewsResponse(response);this.setDefaultProductMenu();if(this.refs.views.views.getViewByID(this.state.view.plot))this.getOperations(this.state.dataset,this.state.variable,this.state.view.plot)};
LASUI.prototype.setDefaultProductMenu=function(){while(this.refs.operations.plot.DOMNode.firstChild)this.refs.operations.plot.DOMNode.removeChild(this.refs.operations.plot.DOMNode.firstChild);while(this.refs.operations.download.DOMNode.firstChild)this.refs.operations.download.DOMNode.removeChild(this.refs.operations.download.DOMNode.firstChild);for(var type in this.refs.operations)this.refs.operations[type].children={};delete this.refs.operations.download.SELECTNode;var setPlotDefault="true";var setDownloadDefault=
"true";var defaultPlotProduct=null;var defaultDownloadProduct=null;for(var type in this.products)for(var product in this.products[type]){var useView=true;if(this.products[type][product].view)for(var axis=0;axis<this.products[type][product].view.length;axis++)if(!this.state.grid.hasAxis(this.products[type][product].view.charAt(axis))||!this.refs.views.views.getViewByID(this.products[type][product].view))useView=false;if(useView){if(!this.refs.operations.plot.children)this.refs.operations.plot.children=
{};if(!this.refs.operations.plot.children[type])this.setProductTypeNode(type);this.setProductNode(type,product);if(defaultPlotProduct==null){var defaultPlotProduct=this.products[type][product];var defaultPlotProductName=product}if(this.state.operation.plot==this.products[type][product].id&&this.state.view.plot==this.products[type][product].view){setPlotDefault=false;this.refs.operations.plot.children[product].radio.checked=true;this.setOperation(this,this.products[type][product].id,this.products[type][product].view,
this.products[type][product].optiondef)}}}if(setPlotDefault){this.setOperation(this,defaultPlotProduct.id,defaultPlotProduct.view,defaultPlotProduct.optiondef);this.refs.operations.plot.children[defaultPlotProductName].radio.checked=true}};
LASUI.prototype.setProductTypeNode=function(type){this.refs.operations.plot.children[type]={};this.refs.operations.plot.children[type].LINode=document.createElement("LI");this.refs.operations.plot.children[type].LINode;this.refs.operations.plot.children[type].title=document.createElement("TEXT");this.refs.operations.plot.children[type].title.innerHTML="<b>"+type+"</b>";this.refs.operations.plot.children[type].LINode.className="LASPlotCategory";this.refs.operations.plot.children[type].LINode.appendChild(this.refs.operations.plot.children[type].title);
this.refs.operations.plot.DOMNode.appendChild(this.refs.operations.plot.children[type].LINode)};
LASUI.prototype.setProductNode=function(type,product){this.refs.operations.plot.children[product]={};this.refs.operations.plot.children[product].LINode=document.createElement("LI");this.refs.operations.plot.children[product].LINode.className="LASPlotType";if(this.products[type][product].view.length==0)this.refs.operations.plot.children[product].LINode.style.display="none";this.refs.operations.plot.children[product].title=document.createTextNode(product);this.refs.operations.plot.children[product].radio=
document.createElement("INPUT");this.refs.operations.plot.children[product].radio.type="radio";this.refs.operations.plot.children[product].radio.name="product";this.refs.operations.plot.children[product].radio.className="LASRadioInputNode";this.refs.operations.plot.children[product].radio.value=product.id;this.refs.operations.plot.children[product].radio.onselect=this.setOperation.LASBind(this,this.products[type][product].id,this.products[type][product].view,this.products[type][product].optiondef,
"plot");this.refs.operations.plot.children[product].radio.onclick=this.setOperation.LASBind(this,this.products[type][product].id,this.products[type][product].view,this.products[type][product].optiondef,"plot");this.refs.operations.plot.children[product].LINode.appendChild(this.refs.operations.plot.children[product].radio);this.refs.operations.plot.children[product].LINode.appendChild(this.refs.operations.plot.children[product].title);this.refs.operations.plot.DOMNode.appendChild(this.refs.operations.plot.children[product].LINode)};
LASUI.prototype.onPlotLoad=function(e){var urlArr=window.frames[this.anchors.output].document.location.search.replace("?","").split("&");for(var i=0;i<urlArr.length;i++)if(urlArr[i].substr(0,3)=="xml")var Req=new LASRequest(unescape(urlArr[i].substr(4,urlArr[i].length)).replace(/\+/g," "));if(Req)if(Req.getXMLText&&!isFeatureEditing()&&this.state.view.plot=="xy"){setMapCurrentSelection(Req.getRangeLo("y"),Req.getRangeHi("y"),Req.getRangeLo("x"),Req.getRangeHi("x"));this.request=Req}if(document.getElementById("wait"))document.getElementById("wait").style.visibility=
"hidden";if(document.getElementById("wait_msg"))document.getElementById("wait_msg").style.display="none";if(document.getElementById("output"))document.getElementById("output").style.visibility="visible";if(document.getElementById("update"))document.getElementById("update").style.color=""};
LASUI.prototype.roundGrid=function(grid){var outgrid={x:{min:0,max:0},y:{min:0,max:0}};outgrid.x.min=Math.round(grid.x.min*1E3)/1E3;outgrid.x.max=Math.round(grid.x.max*1E3)/1E3;outgrid.y.min=Math.round(grid.y.min*1E3)/1E3;outgrid.y.max=Math.round(grid.y.max*1E3)/1E3;return outgrid};
LASUI.prototype.updateConstraints=function(view){if(!this.state.grid)return;if(view==null&&view!="")view=this.state.view.widgets;else this.state.view.widgets=view;while(document.getElementById("Date").firstChild)document.getElementById("Date").removeChild(document.getElementById("Date").firstChild);while(document.getElementById("Depth").firstChild)document.getElementById("Depth").removeChild(document.getElementById("Depth").firstChild);var reset=false;var resetXY=false;if(this.state.lastgrid)if(this.state.grid.response.grid.ID!=
this.state.lastgrid.response.grid.ID)reset=true;if(this.state.lastDataset!=this.state.dataset||this.resetXY){var resetXY=true;this.resetXY=false;this.state.selectGlobal=false}if(this.state.lastDataset!=this.state.dataset)var reset=true;if(!this.initialized)reset=true;if(view.indexOf("x")>=0&&view.indexOf("y")>=0)this.initXYSelect("xy",resetXY);else if(view.indexOf("x")>=0&&view.indexOf("y")<0)this.initXYSelect("x",resetXY);else if(view.indexOf("x")<0&&view.indexOf("y")>=0)this.initXYSelect("y",resetXY);
else if(view.indexOf("x")<0&&view.indexOf("y")<0)this.initXYSelect("pt",resetXY);for(var d=0;d<this.state.grid.response.grid.axis.length;d++)if(view.indexOf(this.state.grid.response.grid.axis[d].type)<0)if(this.state.datasets[this.state.dataset].getChildByID(this.state.variable).grid_type!="scattered"&&!this.refs.analysis.enabled)eval("this.init"+this.state.grid.response.grid.axis[d].type.toUpperCase()+"Constraint('point',reset)");else eval("this.init"+this.state.grid.response.grid.axis[d].type.toUpperCase()+
"Constraint('range',reset)");else eval("this.init"+this.state.grid.response.grid.axis[d].type.toUpperCase()+"Constraint('range',reset)");if(this.refs.analysis.enabled)for(var d=0;d<this.state.grid.response.grid.axis.length;d++)if(view.indexOf(this.state.grid.response.grid.axis[d].type)<0)switch(this.state.grid.response.grid.axis[d].type){case "z":this.refs.DepthWidget[this.refs.DepthWidget.widgetType][1].disabled=true;break;case "t":if(this.refs.DW.widgetType)this.refs.DW.disable("hi");else this.refs.DW[1].disabled=
true;break}else switch(this.state.grid.response.grid.axis[d].type){case "z":this.refs.DepthWidget[this.refs.DepthWidget.widgetType][1].disabled=false;break;case "t":if(this.refs.DW.widgetType)this.refs.DW.enable("hi");else this.refs.DW[1].disabled=false;break}this.initialized=true;if(!this.updating)if(this.autoupdate)this.makeRequest();else this.showUpdateLink();this.updating=false;this.state.lastgrid=this.clone(this.state.grid)};
LASUI.prototype.initXYSelect=function(mode,reset){if(this.state.grid.getAxis("x")&&this.state.grid.getAxis("y")&&reset){setMapTool(mode);setMapDataExtent(parseFloat(this.state.grid.getLo("y")),parseFloat(this.state.grid.getHi("y")),parseFloat(this.state.grid.getLo("x")),parseFloat(this.state.grid.getHi("x")),parseFloat(this.state.grid.getDelta("x")))}else setMapTool(mode)};LASUI.prototype.initXConstraint=function(mode){};LASUI.prototype.initYConstraint=function(mode){};
LASUI.prototype.initZConstraint=function(mode,reset){while(document.getElementById("Depth").firstChild)document.getElementById("Depth").removeChild(document.getElementById("Depth").firstChild);if(!this.state.selection.z)this.state.selection.z={min:null,max:null};if(this.state.grid.hasMenu("z"))if(reset||this.refs.DepthWidget.widgetType!="menu"){this.refs.DepthWidget.menu=[document.createElement("SELECT"),document.createElement("SELECT")];this.refs.DepthWidget.widgetType="menu";for(var m=0;m<this.refs.DepthWidget[this.refs.DepthWidget.widgetType].length;m++){for(var v=
0;v<this.state.grid.getMenu("z").length;v++){var _opt=document.createElement("OPTION");_opt.value=this.state.grid.getMenu("z")[v][1];_opt.className="LASOptionNode";_opt.appendChild(document.createTextNode(this.state.grid.getMenu("z")[v][0]));if(m==1&&v>=this.state.grid.getMenu("z").length-1)_opt.selected=true;if(m==0&&v==0)_opt.selected=true;this.refs.DepthWidget[this.refs.DepthWidget.widgetType][m].appendChild(_opt)}this.refs.DepthWidget[this.refs.DepthWidget.widgetType][m].className="LASSelectNode";
this.refs.DepthWidget[this.refs.DepthWidget.widgetType][m].onchange=this.handleDepthRangeChange.LASBind(this)}}if(this.state.grid.hasArange("z"))if(reset||this.refs.DepthWidget.widgetType!="arange"){this.refs.DepthWidget.arange=[document.createElement("SELECT"),document.createElement("SELECT")];this.refs.DepthWidget.widgetType="arange";for(var m=0;m<this.refs.DepthWidget[this.refs.DepthWidget.widgetType].length;m++){this.refs.DepthWidget[this.refs.DepthWidget.widgetType][m].className="LASSelectNode";
for(var v=parseFloat(this.state.grid.getLo("z"));v<=parseFloat(this.state.grid.getHi("z"));v+=parseFloat(this.state.grid.getDelta("z"))){var _opt=document.createElement("option");_opt.value=v;_opt.className="LASOptionNode";_opt.appendChild(document.createTextNode(v));if(m==1&&v==this.state.grid.getHi("z"))_opt.selected=true;if(m==0&&v==this.state.grid.getLo("z"))_opt.selected=true;this.refs.DepthWidget[this.refs.DepthWidget.widgetType][m].appendChild(_opt)}this.refs.DepthWidget[this.refs.DepthWidget.widgetType][m].onchange=
this.handleDepthRangeChange.LASBind(this)}}switch(mode){case "range":var depth_label2=document.createElement("STRONG");depth_label2.appendChild(document.createTextNode("Minimum Depth ("+this.state.grid.getAxis("z").units+") : "));document.getElementById("Depth").appendChild(depth_label2);document.getElementById("Depth").appendChild(this.refs.DepthWidget[this.refs.DepthWidget.widgetType][0]);document.getElementById("Depth").appendChild(document.createElement("BR"));var depth_label3=document.createElement("STRONG");
depth_label3.appendChild(document.createTextNode("Maximum Depth ("+this.state.grid.getAxis("z").units+") : "));document.getElementById("Depth").appendChild(depth_label3);document.getElementById("Depth").appendChild(this.refs.DepthWidget[this.refs.DepthWidget.widgetType][1]);document.getElementById("Depth").style.display="";break;case "point":var depth_label=document.createElement("STRONG");depth_label.appendChild(document.createTextNode("Depth ("+this.state.grid.getAxis("z").units+") : "));document.getElementById("Depth").appendChild(depth_label);
document.getElementById("Depth").appendChild(this.refs.DepthWidget[this.refs.DepthWidget.widgetType][0]);document.getElementById("Depth").style.display="";break}};
LASUI.prototype.initTConstraint=function(mode,reset){document.getElementById("Date").style.display="";while(document.getElementById("Date").firstChild)document.getElementById("Date").removeChild(document.getElementById("Date").firstChild);if(!this.state.selection.t)this.state.selection.t={min:null,max:null};switch(this.state.grid.getDisplayType("t")){case "widget":if(reset||!this.refs.DW)if(reset||this.refs.DW.widgetType!="DateWidget"){this.refs.DW=new DateWidget(this.state.grid.getLo("t"),this.state.grid.getHi("t"));
this.refs.DW.callback=this.handleDateRangeChange.LASBind(this)}var DWDisplay="";if(this.state.grid.getAxis("t").monthNeeded=="true")DWDisplay+="M";if(this.state.grid.getAxis("t").dayNeeded=="true")DWDisplay+="D";if(this.state.grid.getAxis("t").yearNeeded=="true")DWDisplay+="Y";if(this.state.grid.getAxis("t").hourNeeded=="true"||this.state.grid.getAxis("t").hoursNeeded=="true")DWDisplay+="T";switch(mode){case "range":document.getElementById("Date").innerHTML="<table><tbody><tr><td><table><tbody><tr><td><strong>Start Date :</strong></td></tr><tr><td><strong>End Date :</strong></tr></tbody></table></td><td id='DWAnchor'></td></tr></tbody></table>";
this.refs.DW.render("DWAnchor",DWDisplay,DWDisplay);break;case "point":document.getElementById("Date").innerHTML="<table><tbody><tr><td><table><tbody><tr><td><strong>Date :</strong></td><td id='DWAnchor'></td></tr></tbody></table>";this.refs.DW.render("DWAnchor",DWDisplay);break}break;case "menu":if(reset||!this.refs.DW)if(reset||this.refs.DW[0].tagName!="select"){this.refs.DW=[document.createElement("select"),document.createElement("select")];for(var m=0;m<this.refs.DW.length;m++){this.refs.DW[m].onchange=
this.handleDateRangeChange.LASBind(this);this.refs.DW[m].className="LASSelectNode";for(var v=0;v<this.state.grid.getMenu("t").length;v++){var _opt=document.createElement("option");_opt.value=this.state.grid.getMenu("t")[v][1];_opt.className="LASOptionNode";_opt.appendChild(document.createTextNode(this.state.grid.getMenu("t")[v][0]));if(m==1&&v>=this.state.grid.getMenu("t").length-1)_opt.selected=true;if(m==0&&v==0)_opt.selected=true;this.refs.DW[m].appendChild(_opt)}}}switch(mode){case "range":var date_label=
document.createElement("STRONG");date_label.appendChild(document.createTextNode("Start Date : "));document.getElementById("Date").appendChild(date_label);document.getElementById("Date").appendChild(this.refs.DW[0]);document.getElementById("Date").appendChild(document.createElement("BR"));var label=document.createElement("STRONG");label.appendChild(document.createTextNode("End Date : "));document.getElementById("Date").appendChild(label);document.getElementById("Date").appendChild(this.refs.DW[1]);
break;case "point":var date_label=document.createElement("STRONG");date_label.appendChild(document.createTextNode("Date : "));document.getElementById("Date").appendChild(date_label);document.getElementById("Date").appendChild(this.refs.DW[0]);break}break}};
LASUI.prototype.showUpdateLink=function(){this.expired=true;document.getElementById("update").style.color="#f5ed52";document.getElementById("update").style.visibility="visible";document.getElementById("plotOptionsButton").style.visibility="visible";if(document.getElementById("wait"))document.getElementById("wait").style.visibility="hidden";if(document.getElementById("wait_msg"))document.getElementById("wait_msg").style.display="none";if(document.getElementById("output"))document.getElementById("output").style.visibility=
"visible"};LASUI.prototype.toggleAutoUpdate=function(e,toggle){this.autoupdate=toggle;if(this.autoupdate&&this.expired)this.makeRequest();var e=e||event;e.stopPropagation?e.stopPropagation():(e.cancelBubble=true);return false};LASUI.prototype.makeDownloadRequest=function(){};
LASUI.prototype.makeRequest=function(evt,type){if(!type)var type="plot";if(!this.updating||this.expired){if(type=="plot"&&this.state.operation.plot=="init"){this.getOperations(this.state.dataset,this.state.variable,this.state.view.plot);return null}document.getElementById("output").height="100%";document.getElementById("output").width="100%";document.getElementById("update").style.visibility="visible";document.getElementById("plotOptionsButton").style.visibility="visible";this.request=null;this.uirequest=
"";this.request=new LASRequest("");this.state.view.download=this.state.view.plot;this.state.view.external=this.state.view.plot;this.request.removeVariables();this.request.removeConstraints();if(this.state.dataset==null){alert("Please select a dataset and variables.");return}if(this.state.variable==null){alert("Please select variables in the selected dataset.");return}if(this.state.operation[type]==null){alert("Please select a file format to download.");return}this.request.setOperation(this.state.operation[type]);
this.uirequest+="dsid="+this.state.dataset;this.uirequest+="&catid="+this.state.catid;this.uirequest+="&varid="+this.state.variable;this.uirequest+="&plot="+this.state.operation.plot;this.uirequest+="&view="+this.state.view.plot;var uioptions="";for(var p in this.state.properties[type])if(typeof this.state.properties[type][p]!="function"&&typeof this.state.properties[type][p]=="object")this.request.setProperty(this.state.properties[type][p].type,p,this.urlencode(this.state.properties[type][p].value));
var view=this.state.view[type];this.request.setProperty("ferret","view",view);this.request.removeRegion();this.request.setVariable(this.state.dataset,this.state.variable);this.request.addRegion();if(this.refs.analysis.enabled&&this.state.analysis.name){var Analysis={label:this.state.analysis.name+" "+this.state.datasets[this.state.dataset].getChildByID(this.state.variable).name,axis:[]};for(var axis_id in this.state.analysis.axes){var Axis={type:axis_id,op:this.state.analysis.type};if(this.state.grid.hasAxis(axis_id)){var Axis=
{type:axis_id,op:this.state.analysis.type};switch(axis_id){case "x":Axis.lo=getMapXlo();Axis.hi=getMapXhi();break;case "y":Axis.lo=getMapYlo();Axis.hi=getMapYhi();break;case "t":if(this.state.grid.hasMenu("t")){Axis.lo=this.refs.DW[0].value;Axis.hi=this.refs.DW[1].value}else{Axis.lo=this.refs.DW.getDate1_Ferret();Axis.hi=this.refs.DW.getDate2_Ferret()}break;case "z":Axis.lo=this.refs.DepthWidget[this.refs.DepthWidget.widgetType][0].value;Axis.hi=this.refs.DepthWidget[this.refs.DepthWidget.widgetType][1].value;
break}Analysis.axis.push(Axis)}}if(Analysis.axis.length>0&&this.state.analysis.name!="None")this.request.setAnalysis(0,Analysis)}for(var d=0;d<this.state.grid.response.grid.axis.length;d++)if(!(this.refs.analysis.enabled&&this.state.analysis.name&&this.state.analysis.axes[this.state.grid.response.grid.axis[d].type]))switch(this.state.grid.response.grid.axis[d].type){case "x":if(this.state.view[type].indexOf("x")>=0||this.state.datasets[this.state.dataset].getChildByID(this.state.variable).grid_type==
"scattered")this.request.addRange("x",getMapXlo(),getMapXhi());else this.request.addRange("x",(getMapXlo()+getMapXhi())/2,(getMapXlo()+getMapXhi())/2);break;case "y":if(this.state.view[type].indexOf("y")>=0||this.state.datasets[this.state.dataset].getChildByID(this.state.variable).grid_type=="scattered")this.request.addRange("y",getMapYlo(),getMapYhi());else this.request.addRange("y",(getMapYlo()+getMapYhi())/2,(getMapYlo()+getMapYhi())/2);break;case "t":if(this.state.view[type].indexOf("t")>=0||
this.state.datasets[this.state.dataset].getChildByID(this.state.variable).grid_type=="scattered")if(this.state.grid.hasMenu("t"))this.request.addRange("t",this.refs.DW[0].value,this.refs.DW[1].value);else this.request.addRange("t",this.refs.DW.getDate1_Ferret(),this.refs.DW.getDate2_Ferret());else if(this.state.grid.hasMenu("t"))this.request.addRange("t",this.refs.DW[0].value);else this.request.addRange("t",this.refs.DW.getDate1_Ferret());break;case "z":if(this.state.view[type].indexOf("z")>=0||this.state.datasets[this.state.dataset].getChildByID(this.state.variable).grid_type==
"scattered")this.request.addRange("z",this.refs.DepthWidget[this.refs.DepthWidget.widgetType][0].value,this.refs.DepthWidget[this.refs.DepthWidget.widgetType][1].value);else this.request.addRange("z",this.refs.DepthWidget[this.refs.DepthWidget.widgetType][0].value);break}if(this.refs.constraints)for(var c=0;c<this.refs.constraints.length;c++)if(this.refs.constraints[c].apply.checked)switch(this.refs.constraints[c].type){case "text":this.request.addTextConstraint(this.urlencode(this.refs.constraints[c].lhs.value),
this.urlencode(this.refs.constraints[c].ops.value),this.urlencode(this.refs.constraints[c].rhs.value));break;case "variable":this.request.addVariableConstraint(this.urlencode(this.state.dataset),this.urlencode(this.refs.constraints[c].lhs.value),this.urlencode(this.refs.constraints[c].ops.value),this.urlencode(this.refs.constraints[c].rhs.value));break}document.getElementById("ol_map_widget").onmouseover=null;if(this.state.embed&&type=="plot"){if(document.getElementById("wait"))document.getElementById("wait").style.visibility=
"visible";if(document.getElementById("wait_msg"))document.getElementById("wait_msg").style.display="";document.getElementById("output").style.visibility="hidden";document.getElementById("output").src=this.hrefs.getProduct.url+"?xml="+this.urlencode(this.request.getXMLText())}else window.open(this.hrefs.getProduct.url+"?xml="+this.urlencode(this.request.getXMLText()))}this.updating=false;this.state.lastVariable=this.state.variable;this.state.lastDataset=this.state.dataset;this.state.selectGlobal=false;
if(this.state.grid.hasAxis("x")&&this.state.grid.hasAxis("y"))if(Math.abs(getMapXhi()-getMapXlo()-(this.state.grid.getHi("x")-this.state.grid.getLo("x")))<10&&Math.abs(getMapYhi()-getMapYlo()-(this.state.grid.getHi("y")-this.state.grid.getLo("y")))<5)this.state.selectGlobal=true;if(type=="plot"){this.expired=false;document.getElementById("update").style.color=""}};
LASUI.prototype.getOptions=function(optiondef,type,reset){var url=this.hrefs.getOptions.url+"?opid="+optiondef;var submit=document.createElement("INPUT");var cancel=document.createElement("INPUT");submit.type="submit";submit.value="OK";submit.className="LASSubmitInputNode";var strHandler="this.setChangedOptions('"+type+"');this.hideOptions('"+type+"')";if(type!="plot")strHandler+=";this.makeRequest({},'"+type+"')";submit.onclick=this.genericHandler.LASBind(this,strHandler);cancel.type="submit";cancel.value=
"Cancel";cancel.className="LASSubmitInputNode";cancel.onclick=this.genericHandler.LASBind(this,"this.cancelChangedOptions('"+type+"');this.hideOptions('"+type+"')");var reset=document.createElement("INPUT");reset.type="submit";reset.onclick=this.genericHandler.LASBind(this,"this.resetOptions('"+type+"')");reset.name="Reset";reset.value="Reset";while(this.refs.options[type].DOMNode.firstChild)this.refs.options[type].DOMNode.removeChild(this.refs.options[type].DOMNode.firstChild);this.refs.options[type].DOMNode.appendChild(submit);
this.refs.options[type].DOMNode.appendChild(reset);this.refs.options[type].DOMNode.appendChild(cancel);if(!this.AJAX_cache[url]){this.AJAX_cache[url]="waiting";if(!document.all)var req=new XMLHttpRequest(this);else var req=new ActiveXObject("Microsoft.XMLHTTP");req.onreadystatechange=this.AJAXhandler.LASBind(this,req,"this.AJAX_cache['"+url+"']=req.responseText;this.setOptionList(req.responseText,args[3],args[4],args[5]);",this.refs.options[type].DOMNode,type,reset);req.open("GET",this.hrefs.getOptions.url+
"?opid="+optiondef);req.send(null)}else if(this.AJAX_cache[url]!="waiting")this.setOptionList(this.AJAX_cache[url],this.refs.options[type].DOMNode,type,reset)};
LASUI.prototype.setOptionList=function(strJson,DOMNode,type,reset){var table=document.createElement("TABLE");table.style.margin="-4pt";table.style.marginLeft="6pt";table.cellpadding="0";table.cellspacing="0";var tbody=document.createElement("TBODY");table.appendChild(tbody);DOMNode.appendChild(table);var response=eval("("+strJson+")");var setDefault=true;this.state.properties[type]=[];this.refs.options[type].options=new LASGetOptionsResponse(response);var ct=this.refs.options[type].options.getOptionCount();
if(ct)for(var i=0;i<ct;i++)this.setOptionTRNode(this.refs.options[type].options.getOptionID(i),tbody,type,reset);if(!this.updating)if(this.autoupdate||this.submitOnLoad||this.newVariable){this.submitOnLoad=false;this.newVariable=false;this.makeRequest()}else this.showUpdateLink()};
LASUI.prototype.setOptionTRNode=function(id,TBODYNode,type,reset){if(!this.refs.options.cache)this.refs.options.cache={};if(!this.refs.options.cache[id]||reset){this.refs.options.cache[id]=this.refs.options[type].options.getOptionByID(id);this.refs.options.cache[id].TRNode=document.createElement("TR");this.refs.options.cache[id].TD1=document.createElement("TD");this.refs.options.cache[id].TD1.width="45%";this.refs.options.cache[id].TD1.appendChild(document.createTextNode(this.refs.options.cache[id].title));
this.refs.options.cache[id].TD2=document.createElement("TD");if(this.refs.options.cache[id].menu){this.refs.options.cache[id].SELECTNode=document.createElement("SELECT");this.refs.options.cache[id].SELECTNode.setAttribute("name",id);if(!this.state.properties[type][id])this.state.properties[type][id]={type:"ferret",value:this.refs.options.cache[id].menu.item[0].values};for(var i=0;i<this.refs.options.cache[id].menu.item.length;i++){var option=document.createElement("OPTION");option.value=this.refs.options.cache[id].menu.item[i].values;
option.appendChild(document.createTextNode(this.refs.options.cache[id].menu.item[i].content));this.refs.options.cache[id].SELECTNode.appendChild(option)}this.refs.options.cache[id].TD2.appendChild(this.refs.options.cache[id].SELECTNode)}else{if(!this.state.properties[type][id])this.state.properties[type][id]={type:"ferret",value:""};this.refs.options.cache[id].INPUTNode=document.createElement("INPUT");this.refs.options.cache[id].INPUTNode.type="text";this.refs.options.cache[id].INPUTNode.className=
"LASTextInputNode";this.refs.options.cache[id].TD2.appendChild(this.refs.options.cache[id].INPUTNode)}this.refs.options.cache[id].TD3=document.createElement("TD");this.refs.options.cache[id].A=document.createElement("A");if(!this.info_icon){this.info_icon=document.createElement("img");this.info_icon.src="images/icon_info.gif"}this.refs.options.cache[id].A.appendChild(this.info_icon);this.refs.options.cache[id].A.onclick=this.showOptionInfo.LASBind(this,this.refs.options.cache[id].help);this.refs.options.cache[id].TD3.appendChild(this.refs.options.cache[id].A);
this.refs.options.cache[id].TRNode.appendChild(this.refs.options.cache[id].TD1);this.refs.options.cache[id].TRNode.appendChild(this.refs.options.cache[id].TD2);this.refs.options.cache[id].TRNode.appendChild(this.refs.options.cache[id].TD3)}if(type=="plot"){if(this.refs.options.cache[id].SELECTNode)this.refs.options.cache[id].SELECTNode.onchange=this.setOption.LASBind(this,id,"plot",this.refs.options.cache[id]);if(this.refs.options.cache[id].INPUTNode)this.refs.options.cache[id].INPUTNode.onchange=
this.setOption.LASBind(this,id,"plot",this.refs.options.cache[id]);TBODYNode.appendChild(this.refs.options.cache[id].TRNode)}else{var clone=this.clone(this.refs.options.cache[id]);clone.TD2.innerHTML="";if(clone.SELECTNode){clone.SELECTNode.onchange=this.setOption.LASBind(this,id,type,clone);clone.SELECTNode.selectedIndex=this.refs.options.cache[id].SELECTNode.selectedIndex;clone.SELECTNode.onchange({target:clone.SELECTNode},id,type,clone);clone.TD2.appendChild(clone.SELECTNode)}if(clone.INPUTNode){clone.INPUTNode.onchange=
this.setOption.LASBind(this,id,type,clone);clone.INPUTNode.value=this.refs.options.cache[id].INPUTNode.value;clone.INPUTNode.onchange({target:clone.INPUTNode},id,type,clone);clone.TD2.appendChild(clone.INPUTNode)}while(clone.TRNode.firstChild)clone.TRNode.removeChild(clone.TRNode.firstChild);clone.TRNode.appendChild(clone.TD1);clone.TRNode.appendChild(clone.TD2);clone.TRNode.appendChild(this.refs.options.cache[id].TD3);TBODYNode.appendChild(clone.TRNode)}};
LASUI.prototype.showOptions=function(type){if(this.refs.options[type].options){this.toggleUIMask("");document.getElementById(type+"Options").style.display=""}};LASUI.prototype.hideOptions=function(type){this.refs.options[type].DOMNode.style.display="none";this.toggleUIMask("none")};
LASUI.prototype.resetOptions=function(type){while(this.refs.options[type].DOMNode.firstChild)this.refs.options[type].DOMNode.removeChild(this.refs.options[type].DOMNode.firstChild);this.getOptions(this.state.operations.getOperationByID(this.state.operation[type]).optiondef.IDREF,type,true);this.showOptions(type)};
LASUI.prototype.showOptionInfo=function(evt){if(this.optionInfo)if(this.optionInfo.parentNode)this.optionInfo.parentNode.removeChild(this.optionInfo);this.optionInfo=document.createElement("DIV");document.body.appendChild(this.optionInfo);this.optionInfo.className="LASPopupDIVNode";this.optionInfo.style.left=this.optionInfo.offsetLeft+3+"px";this.optionInfo.style.top=this.optionInfo.offsetTop+3+"px";var close=document.createElement("INPUT");var center=document.createElement("CENTER");close.type="submit";
close.onclick=this.hideOptionInfo.LASBind(this,this.optionInfo);close.name="Close";close.value="Close";this.optionInfo.innerHTML+=arguments[1];center.appendChild(close);this.optionInfo.appendChild(center)};LASUI.prototype.hideOptionInfo=function(){var div=arguments[1];div.parentNode.removeChild(div)};
LASUI.prototype.setOption=function(evt){var args=arguments;var id=args[1];if(evt.target)var node=evt.target;else if(evt.srcElement)var node=evt.srcElement;else return;if(args[3].SELECTNode)this.state.newproperties[args[2]][id]={type:"ferret",value:node.options[node.selectedIndex].value};else this.state.newproperties[args[2]][id]={type:"ferret",value:node.value}};
LASUI.prototype.setChangedOptions=function(type){var ct=0;for(var id in this.state.newproperties[type]){this.state.properties[type][id]=this.state.newproperties[type][id];ct++}if(!this.updating&&type=="plot"&&ct>0)if(this.autoupdate)this.makeRequest();else this.showUpdateLink();this.state.newproperties={plot:[],external:[],download:[]}};
LASUI.prototype.cancelChangedOptions=function(){for(var type in this.state.newproperties)for(var id in this.state.newproperties[type])if(this.refs.options.cache[id]&&this.state.properties[type][id])if(this.refs.options.cache[id].SELECTNode)for(var i=0;i<this.refs.options.cache[id].SELECTNode.length;i++){if(this.refs.options.cache[id].SELECTNode.options[i].value==this.state.properties[type][id].value){this.refs.options.cache[id].SELECTNode.selectedIndex=i;this.refs.options.cache[id].SELECTNode.options[i].selected=
true}}else if(this.refs.options.cache[id].INPUTNode)this.refs.options.cache[id].INPUTNode.value=this.state.properties[type][id].value};LASUI.prototype.onafterdraw=function(evt){this.state.selection.x.min=getMapXlo();this.state.selection.x.max=getMapXhi();this.state.selection.y.min=getMapYlo();this.state.selection.y.max=getMapYhi();if(!this.updating)if(this.autoupdate)this.makeRequest();else this.showUpdateLink()};
LASUI.prototype.handleDepthRangeChange=function(evt){if(!this.updating)if(this.autoupdate)this.makeRequest();else this.showUpdateLink()};LASUI.prototype.handleDepthChange=function(evt){if(!this.updating)if(this.autoupdate)this.makeRequest();else this.showUpdateLink()};LASUI.prototype.handleDateRangeChange=function(evt){if(!this.updating)if(this.autoupdate)this.makeRequest();else this.showUpdateLink()};
LASUI.prototype.handleDateChange=function(evt){if(!this.updating)if(this.autoupdate)this.makeRequest();else this.showUpdateLink()};LASUI.prototype.collapseRootNodes=function(evt){var args=arguments;if(!this.refs[args[1]].isExpanded){this.expand(this.refs[args[1]]);if(args[1]!="categories")this.collapse(this.refs.categories);if(args[1]!="views")this.collapse(this.refs.views);if(args[1]!="operations")this.collapse(this.refs.operations.plot);if(args[1]!="options")this.collapse(this.refs.options)}else this.collapse(this.refs[args[1]])};
LASUI.prototype.showAnalysis=function(){if(this.state.datasets[this.state.dataset].getChildByID(this.state.variable).grid_type=="scattered")return;this.refs.analysis.enabled=true;var reset=false;document.getElementById("Animation").style.visibility="hidden";for(var a in this.refs.analysis.axes)this.refs.analysis.axes[a].style.display="none";if(this.state.grid.hasAxis("x")&&this.state.grid.hasAxis("y"))this.refs.analysis.axes.xy.style.display="";for(var d=0;d<this.state.grid.response.grid.axis.length;d++){eval("this.init"+
this.state.grid.response.grid.axis[d].type.toUpperCase()+"Constraint('range',reset)");this.refs.analysis.axes[this.state.grid.response.grid.axis[d].type.toLowerCase()].style.display="";if(this.state.view.plot.indexOf(this.state.grid.response.grid.axis[d].type.toLowerCase())<0&&!this.state.analysis.axes[this.state.grid.response.grid.axis[d].type.toLowerCase()])switch(this.state.grid.response.grid.axis[d].type.toLowerCase()){case "z":this.refs.DepthWidget[this.refs.DepthWidget.widgetType][1].disabled=
true;break;case "t":if(!this.refs.DW.widgetType)this.refs.DW[1].disabled=true;else this.refs.DW.disable("hi");break}else switch(this.state.grid.response.grid.axis[d].type.toLowerCase()){case "z":this.refs.DepthWidget[this.refs.DepthWidget.widgetType][1].disabled=false;break;case "t":if(!this.refs.DW.widgetType)this.refs.DW[1].disabled=false;else this.refs.DW.enable("hi");break}}document.getElementById(this.anchors.analysis).style.display="";if(this.state.analysis.axes.x&&this.state.analysis.axes.y)this.selectAnalysisAxis(null,
"xy",true);else for(var a in this.state.analysis.axes)this.selectAnalysisAxis(null,a,true);if(this.state.analysis.type)this.selectAnalysisType(null,this.state.analysis.type,true)};
LASUI.prototype.hideAnalysis=function(){this.refs.analysis.enabled=false;var reset=false;if(!this.state.operations.response.operations.error&&this.state.grid.hasAxis("t"))for(var i=0;i<this.state.operations.getOperationCount();i++)if(this.state.operations.getOperationName(i)=="Animation")document.getElementById("Animation").style.visibility="visible";document.getElementById(this.anchors.analysis).style.display="none";for(var d=0;d<this.state.grid.response.grid.axis.length;d++)if(this.state.view.plot.indexOf(this.state.grid.response.grid.axis[d].type.toLowerCase())<
0)switch(this.state.grid.response.grid.axis[d].type.toLowerCase()){case "x":break;case "y":break;case "z":this.refs.DepthWidget[this.refs.DepthWidget.widgetType][1].disabled=false;break;case "t":if(!this.refs.DW.widgetType)this.refs.DW[1].disabled=false;else this.refs.DW.enable("hi");break}this.updateConstraints(this.state.view.plot)};
LASUI.prototype.selectAnalysisType=function(evt){if(evt){if(evt.target)var DOMNode=evt.target;else if(evt.srcElement)var DOMNode=evt.srcElement;this.state.analysis.type=DOMNode.options[DOMNode.selectedIndex].value;this.state.analysis.name=DOMNode.options[DOMNode.selectedIndex].innerHTML}if(this.state.analysis.axes.x&&this.state.analysis.axes.y)this.selectAnalysisAxis(null,"xy",true);else for(var a in this.state.analysis.axes)if(this.state.grid.hasAxis(a))this.selectAnalysisAxis(null,a,true)};
LASUI.prototype.selectAnalysisAxis=function(evt){var axes=arguments[1];if(axes==""||axes=={}||axes==null)try{axes=evt.target.value}catch(e){axes=""}if(axes==""||axes=={}||axes==null)try{axes=evt.srcElement.value}catch(e){axes=""}for(var a in this.state.analysis.axes)if(this.state.view.widgets.indexOf(a)>=0)this.state.view.widgets=this.state.view.widgets.substr(0,this.state.view.widgets.indexOf(a))+this.state.view.widgets.substr(this.state.view.widgets.indexOf(a)+1,this.state.view.widgets.length);
this.state.analysis.axes={};if(arguments[2]==true||evt){var changeVis=false;for(var i=0;i<axes.length;i++){this.state.analysis.axes[axes.charAt(i)]=true;if(this.state.view.plot.indexOf(axes.charAt(i))>=0&&this.state.analysis.type&&this.state.analysis.name!="None")changeVis=true;if(this.state.view.widgets.indexOf(axes.charAt(i))<0&&this.state.analysis.type&&this.state.analysis.name!="None")this.state.view.widgets+=axes.charAt(i)}}else;if(this.state.analysis.type&&this.state.analysis.name!="None")this.updateConstraints(this.state.view.widgets);
else this.updateConstraints(this.state.view.plot);if(changeVis)this.setVisualization(axes)};
LASUI.prototype.setVisualization=function(d){var stop=false;var bestView="";if(this.state.view.plot.indexOf(d)>=0)bestView=this.state.view.plot.substr(0,this.state.view.plot.indexOf(d))+this.state.view.plot.substr(this.state.view.plot.indexOf(d)+d.length,this.state.view.plot.length);if(bestView=="")for(var i in this.state.grid.response.grid.axis)if(d.indexOf(this.state.grid.response.grid.axis[i].type)<0)bestView=this.state.grid.response.grid.axis[i].type;for(var t in this.products)for(var p in this.products[t])if(this.products[t][p].view==
bestView&&!stop)if(this.refs.operations.plot.children[p])if(this.refs.operations.plot.children[p].radio){this.refs.operations.plot.children[p].radio.checked=true;this.refs.operations.plot.children[p].radio.onclick({srcElement:this.refs.operations.plot.children[p].radio});stop=true}this.refs.analysis.axes[d].selected=true};LASUI.prototype.collapse=function(obj){if(obj.ULNode)obj.ULNode.style.display="none";if(obj.IMGNode)obj.IMGNode.src="JavaScript/ui/plus.gif";obj.isExpanded=false};
LASUI.prototype.expand=function(obj){if(obj.ULNode)obj.ULNode.style.display="";if(obj.IMGNode)obj.IMGNode.src="JavaScript/ui/minus.gif";obj.isExpanded=true};LASUI.prototype.clone=function(obj){if(typeof obj!="object")return obj;if(obj.cloneNode)return obj.cloneNode(true);var myclone=new Object;for(var i in obj)myclone[i]=this.clone(obj[i]);return myclone};
LASUI.prototype.urlencode=function(str){var histogram={},histogram_r={},code=0,tmp_arr=[];var ret=str.toString();var replacer=function(search,replace,str){var tmp_arr=[];tmp_arr=str.split(search);return tmp_arr.join(replace)};histogram["!"]="%21";histogram["%20"]="+";ret=encodeURIComponent(ret);for(search in histogram){replace=histogram[search];ret=replacer(search,replace,ret)}return ret.replace(/(\%([a-z0-9]{2}))/g,function(full,m1,m2){return"%"+m2.toUpperCase()});return ret};var whitespace="\n\r\t ",quotes="\"'";function convertEscapes(a){var b;for(b=-1;a.indexOf("&lt;",b+1)>-1;){b=a.indexOf("&lt;",b+1);var c=a.substr(0,b);c+="<";c+=a.substr(b+4,a.length);a=c}for(b=-1;a.indexOf("&gt;",b+1)>-1;){b=a.indexOf("&gt;",b+1);c=a.substr(0,b);c+=">";c+=a.substr(b+4,a.length);a=c}for(b=-1;a.indexOf("&amp;",b+1)>-1;){b=a.indexOf("&amp;",b+1);c=a.substr(0,b);c+="&";c+=a.substr(b+5,a.length);a=c}return a}
function convertToEscapes(a){for(var b=-1;a.indexOf("&",b+1)>-1;){b=a.indexOf("&",b+1);var c=a.substr(0,b);c+="&amp;";c+=a.substr(b+1,a.length);a=c}for(b=-1;a.indexOf("<",b+1)>-1;){b=a.indexOf("<",b+1);c=a.substr(0,b);c+="&lt;";c+=a.substr(b+1,a.length);a=c}for(b=-1;a.indexOf(">",b+1)>-1;){b=a.indexOf(">",b+1);c=a.substr(0,b);c+="&gt;";c+=a.substr(b+1,a.length);a=c}return a}
function _displayElement(a,b){if(a!=null)if(a.nodeType=="ELEMENT"){var c=a.tagName,e="";e="<"+c;for(var f=a.getAttributeNames(),g=0;g<f.length;g++){var h=f[g];e=e+" "+h+"=";e=e+'"'+a.getAttribute(h)+'"'}e+=">";b+=e;if(a.children!=null){a=a.children;for(g=0;g<a.length;g++){e=a[g];if(e.nodeType=="COMMENT")b=b+"<!--"+e.content+"--\>";else if(e.nodeType=="TEXT"){f=trim(e.content,true,true);b+=e.content}else if(e.nodeType=="CDATA"){f=trim(e.content,true,true);b=b+"<![CDATA["+f+"]]\>"}else b=_displayElement(e,
b)}}return b=b+"</"+c+">"}}function firstWhiteChar(a,b){if(isEmpty(a))return-1;for(;b<a.length;)if(whitespace.indexOf(a.charAt(b))!=-1)return b;else b++;return a.length}function isEmpty(a){return a==null||a.length==0}function trim(a,b,c){if(isEmpty(a))return"";if(b==null)b=true;if(c==null)c=true;var e=0,f=0,g=0,h=0;if(b==true)for(;g<a.length&&whitespace.indexOf(a.charAt(g++))!=-1;)e++;if(c==true)for(h=a.length-1;h>=e&&whitespace.indexOf(a.charAt(h--))!=-1;)f++;return a.substring(e,a.length-f)}
function XMLDoc(a,b){this.topNode=null;this.errFn=b;this.createXMLNode=_XMLDoc_createXMLNode;this.error=_XMLDoc_error;this.getUnderlyingXMLText=_XMLDoc_getUnderlyingXMLText;this.handleNode=_XMLDoc_handleNode;this.hasErrors=false;this.insertNodeAfter=_XMLDoc_insertNodeAfter;this.insertNodeInto=_XMLDoc_insertNodeInto;this.loadXML=_XMLDoc_loadXML;this.parse=_XMLDoc_parse;this.parseAttribute=_XMLDoc_parseAttribute;this.parseDTD=_XMLDoc_parseDTD;this.parsePI=_XMLDoc_parsePI;this.parseTag=_XMLDoc_parseTag;
this.removeNodeFromTree=_XMLDoc_removeNodeFromTree;this.replaceNodeContents=_XMLDoc_replaceNodeContents;this.selectNode=_XMLDoc_selectNode;this.selectNodeText=_XMLDoc_selectNodeText;this.source=a;if(this.parse())return this.topNode!=null?this.error("expected close "+this.topNode.tagName):true}function _XMLDoc_createXMLNode(a){return(new XMLDoc(a,this.errFn)).docNode}
function _XMLDoc_error(a){this.hasErrors=true;if(this.errFn)this.errFn("ERROR: "+a);else this.onerror&&this.onerror("ERROR: "+a);return 0}
function _XMLDoc_getTagNameParams(a,b){var c=-1,e,f=a.indexOf("["),g=[];if(f>=0){e=a.indexOf("]");if(e>=0)c=a.substr(f+1,e-f-1);else b.error("expected ] near "+a);a=a.substr(0,f);if(isNaN(c)&&c!="*"){g=c.substr(1,c.length-1);g=g.split("=");if(g[1]){f=g[1].indexOf('"');g[1]=g[1].substr(f+1,g[1].length-1);e=g[1].indexOf('"');if(e>=0)g[1]=g[1].substr(0,e);else b.error('expected " near '+a)}c=-1}else if(c=="*")c=-1}return[a,c,g[0],g[1]]}
function _XMLDoc_getUnderlyingXMLText(){var a="";a+='<?xml version="1.0"?>';if(this.docNode!=null)return a=_displayElement(this.docNode,a)}
function _XMLDoc_handleNode(a){if(a.nodeType=="COMMENT"&&this.topNode!=null)return this.topNode.addElement(a);else if(a.nodeType=="TEXT"||a.nodeType=="CDATA")return this.topNode==null?trim(a.content,true,false)==""?true:this.error("expected document node, found: "+a):this.topNode.addElement(a);else if(a.nodeType=="OPEN"||a.nodeType=="SINGLE"){var b=false;if(this.topNode==null){this.docNode=a;a.parent=null;b=true}else b=this.topNode.addElement(a);if(b&&a.nodeType!="SINGLE")this.topNode=a;a.nodeType=
"ELEMENT";return b}else if(a.nodeType=="CLOSE")if(this.topNode==null)return this.error("close tag without open: "+a.toString());else if(a.tagName!=this.topNode.tagName)return this.error("expected closing "+this.topNode.tagName+", found closing "+a.tagName);else this.topNode=this.topNode.getParent();return true}
function _XMLDoc_insertNodeAfter(a,b){var c=this.getUnderlyingXMLText();a=a.getUnderlyingXMLText();a=c.indexOf(a)+a.length;var e=c.substr(0,a);e+=b.getUnderlyingXMLText();e+=c.substr(a);return new XMLDoc(e,this.errFn)}function _XMLDoc_insertNodeInto(a,b){var c=this.getUnderlyingXMLText();a=a.getUnderlyingXMLText();var e=a.indexOf(">")+1;a=c.indexOf(a)+e;e=c.substr(0,a);e+=b.getUnderlyingXMLText();e+=c.substr(a);return new XMLDoc(e,this.errFn)}
function _XMLDoc_loadXML(a){this.topNode=null;this.hasErrors=false;this.source=a;return this.parse()}
function _XMLDoc_parse(){var a=0;for(err=false;!err;){var b="",c=this.source.indexOf("<",a),e=1;if(c==-1)break;e=c;var f=this.source.substring(a,e);if(f.length!=0)err=!this.handleNode(new XMLNode("TEXT",this,f));if(c==this.source.indexOf("<?",a)){a=this.parsePI(this.source,a+2);if(a==0)err=true}else if(c==this.source.indexOf("<!DOCTYPE",a)){a=this.parseDTD(this.source,c+9);if(a==0)err=true}else{if(c==this.source.indexOf("<!--",a))b="--";if(c==this.source.indexOf("<![CDATA[",a))b="]]";c=this.source.indexOf(b+
">",c);if(c==-1)return this.error("expected closing tag sequence: "+b+">");a=c+b.length;f=this.source.substring(e+1,a);if(b=this.parseTag(f))err=!this.handleNode(b);a=a+1}}return!err}
function _XMLDoc_parseAttribute(a,b,c){for(;b<a.length&&whitespace.indexOf(a.charAt(b))!=-1;)b++;if(b>=a.length)return b;for(var e=b;b<a.length&&a.charAt(b)!="=";)b++;var f="attributes must have values";if(b>=a.length)return this.error(f);for(var g=trim(a.substring(e,b++),false,true);b<a.length&&whitespace.indexOf(a.charAt(b))!=-1;)b++;if(b>=a.length)return this.error(f);f="attribute values must be in quotes";var h=a.charAt(b++);if(quotes.indexOf(h)==-1)return this.error(f);for(e=b;b<a.length&&a.charAt(b)!=
h;)b++;if(b>=a.length)return this.error(f);if(!c.addAttribute(g,trim(a.substring(e,b++),false,true)))return 0;return b}function _XMLDoc_parseDTD(a,b){var c=a.indexOf(">",b);if(c==-1)return this.error("error in DTD: expected '>'");var e="",f=a.indexOf("[",b);if(f!=-1&&f<c)e="]";for(;;){c=a.indexOf(e+">",b);if(c==-1)return this.error("expected closing tag sequence: "+e+">");b=c+e.length+1;if(a.substring(c-1,c+2)!="]]\>")break}return b}function _XMLDoc_parsePI(a,b){return a.indexOf("?>",b)+2}
function _XMLDoc_parseTag(a){if(a.indexOf("!--")==0)return new XMLNode("COMMENT",this,a.substring(3,a.length-2));if(a.indexOf("![CDATA[")==0)return new XMLNode("CDATA",this,a.substring(8,a.length-2));var b=new XMLNode;b.doc=this;if(a.charAt(0)=="/"){b.nodeType="CLOSE";a=a.substring(1)}else b.nodeType="OPEN";if(a.charAt(a.length-1)=="/"){if(b.nodeType=="CLOSE")return this.error("singleton close tag");else b.nodeType="SINGLE";a=a.substring(0,a.length-1)}if(b.nodeType!="CLOSE")b.attributes=[];if(b.nodeType==
"OPEN")b.children=[];a=trim(a,true,true);if(a.length==0)return this.error("empty tag");var c=firstWhiteChar(a,0);if(c==-1){b.tagName=a;return b}b.tagName=a.substring(0,c);for(c=c;c<a.length;){c=this.parseAttribute(a,c,b);if(this.pos==0)return null}return b}function _XMLDoc_removeNodeFromTree(a){var b=this.getUnderlyingXMLText();a=a.getUnderlyingXMLText();var c=b.indexOf(a),e=b.substr(0,c);e+=b.substr(c+a.length);return new XMLDoc(e,this.errFn)}
function _XMLDoc_replaceNodeContents(a,b){b=this.createXMLNode("<X>"+b+"</X>");a.children=b.children;return this}
function _XMLDoc_selectNode(a){a=trim(a,true,true);var b,c,e,f,g;c=this.source?this.docNode:this;if(!a)return c;if(a.indexOf("/")==0)a=a.substr(1);a=a.replace(b,"");if(b=a.split("/")[0]){if(a.indexOf("/")==0)a=a.substr(1);a=a.replace(b,"");e=_XMLDoc_getTagNameParams(b,this);b=e[0];f=e[1];g=e[2];e=e[3];c=b=="*"?c.getElements():c.getElements(b);if(c.length)if(f<0){b=c;for(f=0;f<b.length;){if(c=g?b[f].getAttribute(g)!=e?false:true:true)if(c=b[f].selectNode(a))return c;f++}}else if(f<c.length)if(c=c[f].selectNode(a))return c}}
function _XMLDoc_selectNodeText(a){a=this.selectNode(a);return a!=null?a.getText():null}
function XMLNode(a,b,c){this.content=a=="TEXT"||a=="CDATA"||a=="COMMENT"?c:null;this.children=this.attributes=null;this.doc=b;this.nodeType=a;this.tagName=this.parent="";this.addAttribute=_XMLNode_addAttribute;this.addElement=_XMLNode_addElement;this.getAttribute=_XMLNode_getAttribute;this.getAttributeNames=_XMLNode_getAttributeNames;this.getElementById=_XMLNode_getElementById;this.getElements=_XMLNode_getElements;this.getText=_XMLNode_getText;this.getParent=_XMLNode_getParent;this.getUnderlyingXMLText=
_XMLNode_getUnderlyingXMLText;this.removeAttribute=_XMLNode_removeAttribute;this.selectNode=_XMLDoc_selectNode;this.selectNodeText=_XMLDoc_selectNodeText;this.toString=_XMLNode_toString}function _XMLNode_addAttribute(a,b){this.attributes["_"+a]=b;return true}function _XMLNode_addElement(a){a.parent=this;this.children[this.children.length]=a;return true}function _XMLNode_getAttribute(a){if(this.attributes==null)return null;return this.attributes["_"+a]}
function _XMLNode_getAttributeNames(){if(this.attributes==null)return[];var a=[];for(var b in this.attributes)if(typeof this.attributes[b]!=="function")a[a.length]=b.substring(1);return a}function _XMLNode_getElementById(a){var b=this,c;if(b.getAttribute("id")==a)return b;else{b=b.getElements();for(var e=0;e<b.length;){c=b[e].getElementById(a);if(c!=null)break;e++}}return c}
function _XMLNode_getElements(a){if(this.children==null)return[];for(var b=[],c=0;c<this.children.length;c++)if(this.children[c].nodeType=="ELEMENT"&&(a==null||this.children[c].tagName==a))b[b.length]=this.children[c];return b}function _XMLNode_getText(){if(this.nodeType=="ELEMENT"){if(this.children==null)return null;for(var a="",b=0;b<this.children.length;b++){var c=this.children[b].getText();a+=c==null?"":c}return a}else return this.nodeType=="TEXT"?convertEscapes(this.content):this.content}
function _XMLNode_getParent(){return this.parent}function _XMLNode_getUnderlyingXMLText(){var a="";return a=_displayElement(this,a)}
function _XMLNode_removeAttribute(a){if(a==null)return this.doc.error("You must pass an attribute name into the removeAttribute function");var b=this.getAttributeNames(),c=b.length,e=[];for(intLoop=0;intLoop<c;intLoop++)e[intLoop]=this.getAttribute(b[intLoop]);this.attributes=[];for(intLoop=0;intLoop<c;intLoop++)b[intLoop]!=a&&this.addAttribute(b[intLoop],e[intLoop]);return true}
function _XMLNode_toString(){return""+this.nodeType+":"+(this.nodeType=="TEXT"||this.nodeType=="CDATA"||this.nodeType=="COMMENT"?this.content:this.tagName)}
function LASRequest(a){a||(a='<?xml version="1.0"?><lasRequest href="file:las.xml"><link match="/lasdata/operations/shade"/><args><link match="/lasdata/datasets/coads_climatology_cdf/variables/airt"></link><region><range type="x" low="-180.0" high="180.0"/><range type="y" low="-89.5" high="89.5"/><point type="t" v="15-Jan"/></region></args></lasRequest>');this.DOM=new XMLDoc(a,_LASReq_parseError);a=this.DOM.selectNode("/link");if(!this.DOM.selectNode("/properties")){var b=this.DOM.createXMLNode("<properties></properties>");
this.DOM=this.DOM.insertNodeAfter(a,b)}this.getOperation=LASReq_getOperation;this.setOperation=LASReq_setOperation;this.addPropertyGroup=LASReq_addPropertyGroup;this.removePropertyGroup=LASReq_removePropertyGroup;this.getProperty=LASReq_getProperty;this.setProperty=LASReq_setProperty;this.addProperty=LASReq_addProperty;this.removeProperty=LASReq_removeProperty;this.getVariable=LASReq_getVariable;this.setVariable=LASReq_setVariable;this.addVariable=LASReq_addVariable;this.removeVariable=LASReq_removeVariable;
this.removeVariables=LASReq_removeVariables;this.replaceVariable=LASReq_replaceVariable;this.getDataset=LASReq_getDataset;this.addTextConstraint=LASReq_addTextConstraint;this.addVariableConstraint=LASReq_addVariableConstraint;this.removeConstraints=LASReq_removeConstraints;this.getTextConstraints=LASReq_getTextConstraints;this.getVariableConstraints=LASReq_getVariableConstraints;this.setAnalysis=LASReq_setAnalysis;this.getAnalysis=LASReq_getAnalysis;this.removeAnalysis=LASReq_removeAnalysis;this.addRegion=
LASReq_addRegion;this.removeRegion=LASReq_removeRegion;this.getRangeLo=LASReq_getRangeLo;this.getRangeHi=LASReq_getRangeHi;this.getAxisType=LASReq_getAxisType;this.setRange=LASReq_setRange;this.addRange=LASReq_addRange;this.removeRange=LASReq_removeRange;this.getXMLText=LASReq_getXMLText;this.getVariableNode=LASReq_getVariableNode;this.getVariableNodeByIndex=LASReq_getVariableNodeByIndex}
function LASReq_getOperation(a){var b=this.DOM.selectNode("/link");b=(new String(b.getAttribute("match"))).split("/");var c="";if(a=="LAS6")c=b[3];else(c=(new String(b[3])).split("'")[1])||(c=this.getOperation("LAS6"));return c}function LASReq_setOperation(a,b){var c="";c=b=="LAS6"?"/lasdata/operations/"+a:"/lasdata/operations/operation[@ID='"+a+"']";a=this.DOM.selectNode("/link");a.removeAttribute("match");a.addAttribute("match",c)}
function LASReq_addPropertyGroup(a){if(!this.DOM.selectNode("/properties")){var b=this.DOM.createXMLNode("<properties></properties>");this.DOM=this.DOM.insertNodeAfter(operationNode,b)}var c=this.DOM.selectNode("/properties");if(!this.DOM.selectNode("/properties/"+a)){b=this.DOM.createXMLNode("<"+a+"></"+a+">");this.DOM=this.DOM.insertNodeInto(c,b)}}function LASReq_removePropertyGroup(a){if(a=this.DOM.selectNode("/properties/"+a))this.DOM=this.DOM.removeNodeFromTree(a)}
function LASReq_getProperty(a,b){a="/properties/"+a+"/"+b;return this.DOM.selectNode(a)?this.DOM.selectNodeText(a):null}function LASReq_setProperty(a,b,c){var e=this.DOM.selectNode("/properties/"+a+"/"+b);if(e)this.DOM=this.DOM.replaceNodeContents(e,c);else this.addProperty(a,b,c)}
function LASReq_addProperty(a,b,c){var e="/properties/"+a;(e=this.DOM.selectNode(e))||this.addPropertyGroup(a);if(this.DOM.selectNode("/properties/"+a+"/"+b))this.setProperty(a,b,c);else{e="/properties/"+a;e=this.DOM.selectNode(e);a=this.DOM.createXMLNode("<"+b+">"+c+"</"+b+">");this.DOM=this.DOM.insertNodeInto(e,a)}}function LASReq_removeProperty(a,b){if(a=this.DOM.selectNode("/properties/"+a+"/"+b))this.DOM=this.DOM.removeNodeFromTree(a)}
function LASReq_getDataset(a){a=this.DOM.selectNode("/args/link["+(a?a:0)+"]");matchString=new String(a.getAttribute("match"));return matchString.split("/")[3]}function LASReq_getVariable(a){if(a=this.DOM.selectNode("/args/link["+(a?a:0)+"]")){matchString=new String(a.getAttribute("match"));return matchString.split("/")[5]}}function LASReq_setVariable(a,b){this.removeVariables();this.addVariable(a,b)}
function LASReq_addVariable(a,b){a=this.DOM.createXMLNode('<link match="/lasdata/datasets/'+a+"/variables/"+b+'"></link>');b=this.DOM.selectNode("/args");var c=b.getElements();this.DOM=c.length==0?this.DOM.insertNodeInto(b,a):this.DOM.insertNodeAfter(c[c.length-1],a)}
function LASReq_OLD_removeVariable(a,b){a=this.DOM.selectNode("/args").getElements("link");for(i=0;i<a.length;i++){matchString=new String(a[i].getAttribute("match"));if(matchString.split("/")[5]==b)this.DOM=this.DOM.removeNodeFromTree(a[i])}}function LASReq_removeVariable(a){a=a?a:0;var b=this.DOM.selectNode("/args").getElements("link");if(b.length>a)this.DOM=this.DOM.removeNodeFromTree(b[a])}
function LASReq_removeVariables(){var a=this.DOM.selectNode("/args").getElements("link");for(i=0;i<a.length;i++)this.DOM=this.DOM.removeNodeFromTree(a[i])}function LASReq_replaceVariable(a,b,c){a=this.DOM.createXMLNode('<link match="/lasdata/datasets/'+a+"/variables/"+b+'"></link>');c=this.DOM.selectNode("/args/link["+(c?c:0)+"]");this.DOM=this.DOM.insertNodeAfter(c,a);this.DOM=this.DOM.removeNodeFromTree(c)}
function LASReq_addTextConstraint(a,b,c,e){var f=this.DOM.selectNode("/args");a=this.DOM.createXMLNode('<constraint id="'+e+'"type="text"><v>'+a+"</v><v>"+b+"</v><v>"+c+"</v></constraint>");this.DOM=this.DOM.insertNodeInto(f,a)}
function LASReq_getTextConstraints(){var a=[],b=this.DOM.selectNode("/args").getElements("constraint"),c=0;for(i=0;i<b.length;i++){constraintType=new String(b[i].getAttribute("type"));var e=b[i].getAttribute("id")?b[i].getAttribute("id"):"";if(constraintType=="text"){var f=b[i].getElements("v");tc={name:f[0].getText(),op:f[1].getText(),value:f[2].getText(),id:e};a[c++]=tc}}return a}
function LASReq_getVariableConstraints(){var a=[],b=this.DOM.selectNode("/args").getElements("constraint"),c=0;for(i=0;i<b.length;i++){constraintType=new String(b[i].getAttribute("type"));var e=b[i].getAttribute("id")?b[i].getAttribute("id"):"";if(constraintType=="variable"){var f=b[i].getElements("link"),g=(new String(f[0].getAttribute("match"))).split("/");f=g[3];g=g[5];var h=b[i].getAttribute("op"),j=b[i].getElements("v")[0].getText();vc={dsID:f,varID:g,op:h,value:j,id:e};a[c++]=vc}}return a}
function LASReq_addVariableConstraint(a,b,c,e,f){var g=this.DOM.selectNode("/args");a=this.DOM.createXMLNode('<constraint id="'+f+'" type="variable" op="'+c+'">'+('<link match="/lasdata/datasets/'+a+"/variables/"+b+'"/>')+"<v>"+e+"</v></constraint>");this.DOM=this.DOM.insertNodeInto(g,a)}function LASReq_removeConstraints(){var a=this.DOM.selectNode("/args").getElements("constraint");for(i=0;i<a.length;i++)this.DOM=this.DOM.removeNodeFromTree(a[i])}
function LASReq_getAnalysis(a){var b=null;if(b=this.getVariableNodeByIndex(a))if(a=b.getElements("analysis")[0]){b={};b.axis=[];b.label=String(a.getAttribute("label"));a=a.getElements("axis");for(i=0;i<a.length;i++){b.axis[i]=Object;b.axis[i].type=String(a[i].getAttribute("type"));b.axis[i].lo=String(a[i].getAttribute("lo"));b.axis[i].hi=String(a[i].getAttribute("hi"));b.axis[i].op=String(a[i].getAttribute("op"))}}else b=null;else b=null;return b}
function LASReq_setAnalysis(a,b){a=this.getVariableNodeByIndex(a);var c='<analysis label="'+b.label+'"></analysis>',e=this.DOM.createXMLNode(c);for(i=0;i<b.axis.length;i++){c='<axis type="'+b.axis[i].type+'" lo="'+b.axis[i].lo+'" hi="'+b.axis[i].hi+'" op="'+b.axis[i].op+'"/>';c=this.DOM.createXMLNode(c);e.addElement(c)}this.DOM=this.DOM.insertNodeInto(a,e)}
function LASReq_removeAnalysis(a){a=this.getVariableNodeByIndex(a).getElements("analysis");for(i=0;i<a.length;i++)this.DOM=this.DOM.removeNodeFromTree(a[i])}function LASReq_addRegion(){var a=this.DOM.createXMLNode("<region></region>"),b=this.DOM.selectNode("/args"),c=b.getElements();this.DOM=c.length==0?this.DOM.insertNodeInto(b,a):this.DOM.insertNodeAfter(c[c.length-1],a)}
function LASReq_removeRegion(a){a=a?a:0;var b=this.DOM.selectNode("/args").getElements("region");if(b.length>a)this.DOM=this.DOM.removeNodeFromTree(b[a])}function LASReq_getRangeLo(a,b){var c=null;c=this.getAxisType(a,b);if(c=="range"){b=b?b:0;a=this.DOM.selectNode("/args/region["+b+']/range[@type="'+a+'"]');c=a.getAttribute("low")}else if(c=="point"){b=b?b:0;a=this.DOM.selectNode("/args/region["+b+']/point[@type="'+a+'"]');c=a.getAttribute("v")}else c=null;return c}
function LASReq_getRangeHi(a,b){var c=null;return c=this.getAxisType(a,b)=="range"?this.DOM.selectNode("/args/region["+(b?b:0)+']/range[@type="'+a+'"]').getAttribute("high"):null}function LASReq_getAxisType(a,b){var c=null;b=b?b:0;var e=this.DOM.selectNode("/args/region["+b+']/range[@type="'+a+'"]');if(e)c="range";else if(e=this.DOM.selectNode("/args/region["+b+']/point[@type="'+a+'"]'))c="point";return c}function LASReq_setRange(a,b,c,e){this.removeRange(a,e);this.addRange(a,b,c,e)}
function LASReq_addRange(a,b,c,e){e=e?e:0;var f=this.DOM.selectNode("/args/region["+e+"]");f||this.addRegion();f="";f=c!=null&&c!=b?'<range type="'+a+'" low="'+b+'" high="'+c+'"/>':'<point type="'+a+'" v="'+b+'"/>';a=this.DOM.createXMLNode(f);f=this.DOM.selectNode("/args/region["+e+"]");this.DOM=this.DOM.insertNodeInto(f,a)}
function LASReq_removeRange(a,b){b=b?b:0;if(this.DOM.selectNode("/args/region["+b+"]")){var c=this.DOM.selectNode("/args/region["+b+']/range[@type="'+a+'"]');if(c)this.DOM=this.DOM.removeNodeFromTree(c);else if(c=this.DOM.selectNode("/args/region["+b+']/point[@type="'+a+'"]'))this.DOM=this.DOM.removeNodeFromTree(c)}}function LASReq_getXMLText(){return this.DOM.getUnderlyingXMLText()}
function LASReq_getVariableNode(a,b){a=this.DOM.selectNode("/args").getElements("link");for(i=0;i<a.length;i++){matchString=new String(a[i].getAttribute("match"));if(matchString.split("/")[5]==b)return a[i]}}function LASReq_getVariableNodeByIndex(a){var b=this.DOM.selectNode("/args").getElements("link");return b[a]?b[a]:null}function _LASReq_parseError(a){alert(a)}
function LASGetGridResponse(a){this.response=a;this.hasAxis=LASGetGridResponse_hasAxis;this.hasArange=LASGetGridResponse_hasArange;this.hasMenu=LASGetGridResponse_hasMenu;this.getAxis=LASGetGridResponse_getAxis;this.getLo=LASGetGridResponse_getLo;this.getHi=LASGetGridResponse_getHi;this.getDelta=LASGetGridResponse_getDelta;this.getSize=LASGetGridResponse_getSize;this.getUnits=LASGetGridResponse_getUnits;this.getID=LASGetGridResponse_getID;this.getDisplayType=LASGetGridResponse_getDisplayType;this.getRenderFormat=
LASGetGridResponse_getRenderFormat;this.getMenu=LASGetGridResponse_getMenu;if(a==null){a="getGrid.do returned a null response.";throw a;}else if(a.status!="ok"){a=a.error?a.error:"Unknown error in LASGetGridResponse.";throw a;}}function LASGetGridResponse_getAxis(a){a=String(a).toLowerCase();for(var b=null,c=0;c<this.response.grid.axis.length;c++)if(this.response.grid.axis[c].type==a)b=this.response.grid.axis[c];return b}
function LASGetGridResponse_hasAxis(a){var b=false;if(this.getAxis(String(a).toLowerCase()))b=true;return b}function LASGetGridResponse_hasArange(a){a=String(a).toLowerCase();var b=false;if(this.hasAxis(a))if(this.getAxis(a).arange)b=true;return b}function LASGetGridResponse_hasMenu(a){a=String(a).toLowerCase();var b=false;if(this.hasAxis(a))if(this.getAxis(a).v)b=true;return b}
function LASGetGridResponse_getLo(a){var b=String(a).toLowerCase(),c=null;if(b=="t")c=this.getAxis(b).lo;else if(this.hasMenu(a))c=this.getAxis(b).v[0];else{a=Number(this.getAxis(b).arange.start);c=Number(this.getAxis(b).arange.size);b=Number(this.getAxis(b).arange.step);c=b<0?a+(c-1)*b:a}return c}
function LASGetGridResponse_getHi(a){var b=String(a).toLowerCase(),c=null;if(b=="t")c=this.getAxis(b).hi;else if(this.hasMenu(a)){a=this.getAxis(b).v.length-1;c=this.getAxis(b).v[a]}else{a=Number(this.getAxis(b).arange.start);c=Number(this.getAxis(b).arange.size);b=Number(this.getAxis(b).arange.step);c=b<0?a:a+(c-1)*b}return c}function LASGetGridResponse_getDelta(a){a=String(a).toLowerCase();var b=null;if(this.hasArange(a))b=this.getAxis(a).arange.step;return Number(b)}
function LASGetGridResponse_getSize(a){var b=String(a).toLowerCase(),c=null;if(this.hasArange(b))c=this.getAxis(b).arange.size;else if(this.hasMenu(a))c=this.getAxis(b).v.length;return Number(c)}function LASGetGridResponse_getUnits(a){var b=null;a=String(a).toLowerCase();if(this.hasAxis(a))b=this.getAxis(a).units;return b}function LASGetGridResponse_getID(a){var b=null;a=String(a).toLowerCase();if(this.hasAxis(a))b=this.getAxis(a).display_type;return b}
function LASGetGridResponse_getDisplayType(a){var b=String(a).toLowerCase(),c=null;if(this.hasAxis(a))if(this.getAxis(b).display_type)c=this.getAxis(b).display_type;return c}function LASGetGridResponse_getRenderFormat(a){var b=null;switch(String(a).toLowerCase()){case "t":b="";if(this.getAxis("t").yearNeeded=="true")b+="Y";if(this.getAxis("t").monthNeeded=="true")b+="M";if(this.getAxis("t").dayNeeded=="true")b+="D";if(this.getAxis("t").hourNeeded=="true")b+="T";break}return b}
function LASGetGridResponse_getMenu(a){a=String(a).toLowerCase();var b=null,c=null;if(this.getAxis(a).v){b=[];c=this.getAxis(a).v;for(var e=0;e<c.length;e++)if(a=="t"){var f=String(c[e].content).toLowerCase();if(f=="jan")c[e].content="15-Jan";if(f=="feb")c[e].content="15-Feb";if(f=="mar")c[e].content="15-Mar";if(f=="apr")c[e].content="15-Apr";if(f=="may")c[e].content="15-May";if(f=="jun")c[e].content="15-Jun";if(f=="jul")c[e].content="15-Jul";if(f=="aug")c[e].content="15-Aug";if(f=="sep")c[e].content=
"15-Sep";if(f=="oct")c[e].content="15-Oct";if(f=="nov")c[e].content="15-Nov";if(f=="dec")c[e].content="15-Dec";b[e]=new Array(c[e].label,c[e].content)}else b[e]=new Array(c[e],c[e])}return b}
function LASGetCategoriesResponse(a){this.response=a;if(!this.response)return false;this.getDatasetID=LASGetCategoriesResponse_getDatasetID;this.getCategoryType=LASGetCategoriesResponse_getCategoryType;this.getCategorySize=LASGetCategoriesResponse_getCategorySize;this.getChild=LASGetCategoriesResponse_getChild;this.getChildrenType=LASGetCategoriesResponse_getChildrenType;this.getChildID=LASGetCategoriesResponse_getChildID;this.getChildDatasetID=LASGetCategoriesResponse_getChildDatasetID;this.getDatasetName=
LASGetCategoriesResponse_getDatasetName;this.getChildType=LASGetCategoriesResponse_getChildType;this.getChildByID=LASGetCategoriesResponse_getChildByID;this.getChildChildrenType=LASGetCategoriesResponse_getChildChildrenType;this.getChildName=LASGetCategoriesResponse_getChildName}function LASGetCategoriesResponse_getCategoryType(){return this.response.categories.category?this.response.categories.category[0]?this.response.categories.category[0].dataset?"dataset":"category":null:null}
function LASGetCategoriesResponse_getDatasetID(a){if(a==null)a=0;if(this.getCategoryType()=="dataset"){var b=0,c=this.response.categories.category[0].dataset.length;c||(c=1);for(d=0;d<c;d++)if(c==1)return this.response.categories.category[0].dataset.ID;else if(this.response.categories.category[0].dataset[d].variables)if(this.response.categories.category[0].dataset[d].variables.variable){lastct=b;b+=this.response.categories.category[0].dataset[d].variables.variable.length;if(a>=lastct&&a<b)return this.response.categories.category[0].dataset[d].ID}}else return"category"}
function LASGetCategoriesResponse_getDatasetName(){if(this.getCategoryType()=="dataset")if(this.response.categories.category[0].dataset.name)return this.response.categories.category[0].dataset.name;else{if(this.response.categories.category[0].name)return this.response.categories.category[0].name}else return"category"}
function LASGetCategoriesResponse_getCategorySize(){if(this.getCategoryType()=="dataset"){var a=0,b=this.response.categories.category[0].dataset.length;b||(b=1);for(i=0;i<b;i++)if(b==1){if(this.response.categories.category[0].dataset.variables.variable)a+=this.response.categories.category[0].dataset.variables.variable.length}else if(this.response.categories.category[0].dataset[i].variables)if(this.response.categories.category[0].dataset[i].variables.variable)a+=this.response.categories.category[0].dataset[i].variables.variable.length;
return a}else return this.response.categories[this.getCategoryType()]?this.response.categories[this.getCategoryType()].length:false}
function LASGetCategoriesResponse_getChild(a){if(this.getCategoryType()=="dataset"){var b=0,c=this.response.categories.category[0].dataset.length;c||(c=1);for(d=0;d<c;d++)if(c==1){if(this.response.categories.category[0].dataset.variables.variable)if(this.response.categories.category[0].dataset.variables.variable){lastct=b;b+=this.response.categories.category[0].dataset.variables.variable.length;if(a>=lastct&&a<b)return this.response.categories.category[0].dataset.variables.variable[a-lastct]}}else if(this.response.categories.category[0].dataset[d].variables)if(this.response.categories.category[0].dataset[d].variables.variable){lastct=
b;b+=this.response.categories.category[0].dataset[d].variables.variable.length;if(a>=lastct&&a<b)return this.response.categories.category[0].dataset[d].variables.variable[a-lastct]}}else this.getCategoryType();return this.response.categories[this.getCategoryType()][a]}function LASGetCategoriesResponse_getChildrenType(a){switch(this.getCategoryType()){case "category":return"categories";case "dataset":return"variables";default:return false}}
function LASGetCategoriesResponse_getChildType(a){switch(this.getChildChildrenType(a)){case "variables":return"dataset";case "categories":return"category";default:return false}}function LASGetCategoriesResponse_getChildChildrenType(a){return this.getChild(a).children?this.getChild(a).children:false}function LASGetCategoriesResponse_getChildID(a){if(this.getChild(a).ID)return this.getChild(a).ID}
function LASGetCategoriesResponse_getChildDatasetID(a){if(this.getChild(a).children_dsid)return this.getChild(a).children_dsid}function LASGetCategoriesResponse_getChildName(a){if(this.getChild(a).ID)return this.getChild(a).name}function LASGetCategoriesResponse_getChildByID(a){for(var b=0;b<this.getCategorySize();b++)if(this.getChildID(b)==a)return this.getChild(b)}
function LASGetDataConstraintsResponse(a){this.response=a;if(!this.response)return false;this.getConstraintID=LASGetDataConstraintsResponse_getConstraintID;this.getConstraintType=LASGetDataConstraintsResponse_getConstraintType;this.getConstraintSize=LASGetDataConstraintsResponse_getConstraintSize;this.getChild=LASGetDataConstraintsResponse_getChild;this.getChildrenType=LASGetDataConstraintsResponse_getChildrenType;this.getChildID=LASGetDataConstraintsResponse_getChildID;this.getChildType=LASGetDataConstraintsResponse_getChildType;
this.getChildName=LASGetDataConstraintsResponse_getChildName}function LASGetDataConstraintsResponse_getConstraintType(){return this.response.DataConstraints.Constraint?this.response.DataConstraints.Constraint[0]?this.response.DataConstraints.Constraint[0].dataset?"dataset":"Constraint":null:null}function LASGetDataConstraintsResponse_getConstraintID(){return this.getConstraintType()=="dataset"?this.response.DataConstraints.Constraint[0].constraint.ID:"Constraint"}
function LASGetDataConstraintsResponse_getConstraintSize(){if(this.getConstraintType()=="dataset"){if(this.response.DataConstraints.Constraint[0].dataset.variables.variable)return this.response.DataConstraints.Constraint[0].dataset.variables.variable.length}else return this.response.DataConstraints[this.getConstraintType()]?this.response.DataConstraints[this.getConstraintType()].length:false}
function LASGetDataConstraintsResponse_getChild(a){if(this.getConstraintType()=="dataset")return this.response.DataConstraints.Constraint[0].dataset.variables.variable[a];else this.getConstraintType();return this.response.DataConstraints[this.getConstraintType()][a]}function LASGetDataConstraintsResponse_getChildrenType(a){switch(this.getConstraintType()){case "Constraint":return"DataConstraints";case "dataset":return"variables";default:return false}}
function LASGetDataConstraintsResponse_getChildType(a){switch(this.getChildChildrenType(a)){case "variables":return"dataset";case "DataConstraints":return"Constraint";default:return false}}function LASGetDataConstraintsResponse_getChildID(a){if(this.getChild(a).ID)return this.getChild(a).ID}function LASGetDataConstraintsResponse_getChildName(a){if(this.getChild(a).ID)return this.getChild(a).name}
function LASGetViewsResponse(a){this.response=a;if(!this.response)return false;this.getAllViews=LASGetViewsResponse_getAllViews;this.getViewCount=LASGetViewsResponse_getViewCount;this.getView=LASGetViewsResponse_getView;this.getViewID=LASGetViewsResponse_getViewID;this.getViewByID=LASGetViewsResponse_getViewByID;this.getViewName=LASGetViewsResponse_getViewName}function LASGetViewsResponse_getAllViews(){return this.response.views.view?this.response.views.view:null}
function LASGetViewsResponse_getViewCount(){return this.getAllViews()?this.getAllViews().length:-1}function LASGetViewsResponse_getView(a){return a>=0&&a<this.getViewCount()?this.getAllViews()[a]:null}function LASGetViewsResponse_getViewID(a){return this.getView(a)?this.getView(a).value:null}function LASGetViewsResponse_getViewByID(a){for(var b=0;b<this.getViewCount();b++)if(this.getView(b).value==a)return this.getView(b);return null}
function LASGetViewsResponse_getViewName(a){return this.getView(a)?this.getView(a).name:null}
function LASGetOperationsResponse(a){this.response=a;if(!this.response)return false;this.getAllOperations=LASGetOperationsResponse_getAllOperations;this.getOperationCount=LASGetOperationsResponse_getOperationCount;this.getOperation=LASGetOperationsResponse_getOperation;this.getOperationID=LASGetOperationsResponse_getOperationID;this.getOperationByID=LASGetOperationsResponse_getOperationByID;this.getOperationName=LASGetOperationsResponse_getOperationName}
function LASGetOperationsResponse_getAllOperations(){return this.response.operations.operation?this.response.operations.operation:null}function LASGetOperationsResponse_getOperationCount(){return this.getAllOperations()?this.getAllOperations().length:-1}function LASGetOperationsResponse_getOperation(a){return a>=0&&a<this.getOperationCount()?this.getAllOperations()[a]:null}function LASGetOperationsResponse_getOperationID(a){return this.getOperation(a)?this.getOperation(a).ID:null}
function LASGetOperationsResponse_getOperationByID(a){for(var b=0;b<this.getOperationCount();b++)if(this.getOperation(b).ID==a)return this.getOperation(b);return null}function LASGetOperationsResponse_getOperationName(a){return this.getOperation(a)?this.getOperation(a).name:null}
function LASGetOptionsResponse(a){this.response=a;if(!this.response)return false;this.getAllOptions=LASGetOptionsResponse_getAllOptions;this.getOptionCount=LASGetOptionsResponse_getOptionCount;this.getOption=LASGetOptionsResponse_getOption;this.getOptionID=LASGetOptionsResponse_getOptionID;this.getOptionByID=LASGetOptionsResponse_getOptionByID;this.getOptionName=LASGetOptionsResponse_getOptionName;this.getOptionType=LASGetOptionsResponse_getOptionType}
function LASGetOptionsResponse_getAllOptions(){return this.response.options.option?this.response.options.option:null}function LASGetOptionsResponse_getOptionCount(){return this.getAllOptions()?this.getAllOptions().length:-1}function LASGetOptionsResponse_getOption(a){return a>=0&&a<this.getOptionCount()?this.getAllOptions()[a]:null}function LASGetOptionsResponse_getOptionID(a){return this.getOption(a)?this.getOption(a).ID:null}
function LASGetOptionsResponse_getOptionByID(a){for(var b=0;b<this.getOptionCount();b++)if(this.getOption(b).ID==a)return this.getOption(b);return null}function LASGetOptionsResponse_getOptionName(a){return this.getOption(a)?this.getOption(a).title:null}function LASGetOptionsResponse_getOptionType(a){return this.getOption(a).menu?"menu":this.getOption(a).textfield?"text":null}
function Querystring(a){this.params={};this.get=Querystring_get;if(a==null)a=location.search.substring(1,location.search.length);if(a.length!=0){a=a.replace(/\+/g," ");a=a.split("&");for(var b=0;b<a.length;b++){var c;c=a[b].split("=");var e=unescape(c[0]);c=c.length==2?unescape(c[1]):e;this.params[e]=c}}}function Querystring_get(a,b){if(b==null)b=null;a=this.params[a];if(a==null)a=b;return a}
function DateWidget(a,b,c,e,f,g){this.setCallback=DateWidget_setCallback;this.render=DateWidget_render;this.renderToNode=DateWidget_renderToNode;this.disable=DateWidget_disable;this.enable=DateWidget_enable;this.show=DateWidget_show;this.hide=DateWidget_hide;this.getValue=DateWidget_getValue;this.setValue=DateWidget_setValue;this.initializeYearMenu=DateWidget_initializeYearMenu;this.setDateRange=DateWidget_setDateRange;this.setDate1=DateWidget_setDate1;this.setDate2=DateWidget_setDate2;this.resetDateRange=
DateWidget_resetDateRange;this.resetDate1=DateWidget_resetDate1;this.resetDate2=DateWidget_resetDate2;this.toString=DateWidget_toString;this.getDateLo=DateWidget_getDateLo;this.getDateHi=DateWidget_getDateHi;this.getDate1=DateWidget_getDate1;this.getDate2=DateWidget_getDate2;this.alert=DateWidget_alert;this.setDeltaMinutes=DateWidget_setDeltaMinutes;this.setOffsetMinutes=DateWidget_setOffsetMinutes;this.getDate1_Ferret=DateWidget_getDate1_Ferret;this.getDate2_Ferret=DateWidget_getDate2_Ferret;this.parseDate=
DateWidget_parseDate;this.febDays=DateWidget_febDays;this.twoDigit=DateWidget_twoDigit;this.fourDigit=DateWidget_fourDigit;this.correctOrder=DateWidget_correctOrder;this.addEvent=DateWidget_addEvent;this.flash=DateWidget_flash;this.selectYear=DateWidget_selectYear;this.selectMonth=DateWidget_selectMonth;this.selectDay=DateWidget_selectDay;this.selectTime=DateWidget_selectTime;this.selectChange=DateWidget_selectChange;this.widgetType="DateWidget";this.visible=this.disabled=this.climatology=0;this.deltaMinutes=
c?c:1440;this.offsetMinutes=e?e:0;var h,j;try{h=this.parseDate(a,f)}catch(k){a='DateWidget ERROR: new:  error parsing "'+a+'"\n'+k;alert(a)}try{j=this.parseDate(b,g)}catch(n){a='DateWidget ERROR: new:  error parsing "'+b+'"\n'+n;alert(a)}this.yearLo=h[0];this.monthLo=h[1];this.dayLo=h[2];this.hourLo=h[3];this.minuteLo=h[4];this.secondLo=h[5];this.yearHi=j[0];this.monthHi=j[1];this.dayHi=j[2];this.hourHi=j[3];this.minuteHi=j[4];this.secondHi=j[5];this.year1=this.yearLo;this.month1=this.monthLo;this.day1=
this.dayLo;this.hour1=this.hourLo;this.minute1=this.minuteLo;this.second1=this.secondLo;this.year2=this.yearHi;this.month2=this.monthHi;this.day2=this.dayHi;this.hour2=this.hourHi;this.minute2=this.minuteHi;this.second2=this.secondHi}
function DateWidget_renderToNode(a,b,c){this.node=a;this.menu_set_1=b;this.menu_set_2=c;for(var e=a.childNodes,f=e.length-1;f>=0;f--){var g=e[f];g&&a.removeChild(g)}var h,j,k,n,m,o,p,q,r=f=0;if(!b){error_msg='DateWidget ERROR:  render: menu_set_1 must be defined and  must contain only characters from "YMDT"';throw error_msg;}e=document.createElement("select");e.setAttribute("id","DW_Year1");e.widget=this;this.Year1=e;if(b.indexOf("Y")<0){this.Year1.style.display="none";this.climatology=f=1;text1=
document.createTextNode("Climatology:  ");h=document.createElement("span");h.setAttribute("id","DW_Text1");h.appendChild(text1);h.widget=this;this.Text1=h}g=document.createElement("select");g.setAttribute("id","DW_Month1");g.widget=this;this.Month1=g;if(b.indexOf("M")<0)this.Month1.style.display="none";j=document.createElement("select");j.setAttribute("id","DW_Day1");j.widget=this;this.Day1=j;if(b.indexOf("D")<0)this.Day1.style.display="none";k=document.createElement("select");k.setAttribute("id",
"DW_Time1");k.widget=this;this.Time1=k;if(b.indexOf("T")<0)this.Time1.style.display="none";if(c){m=document.createElement("select");m.setAttribute("id","DW_Year2");m.widget=this;this.Year2=m;if(c.indexOf("Y")<0){this.Year2.style.display="none";r=1;text2=document.createTextNode("Climatology:  ");n=document.createElement("span");n.setAttribute("id","DW_Text2");n.appendChild(text2);n.widget=this;this.Text2=n}o=document.createElement("select");o.setAttribute("id","DW_Month2");o.widget=this;this.Month2=
o;if(c.indexOf("M")<0)this.Month2.style.display="none";p=document.createElement("select");p.setAttribute("id","DW_Day2");p.widget=this;this.Day2=p;if(c.indexOf("D")<0)this.Day2.style.display="none";q=document.createElement("select");q.setAttribute("id","DW_Time2");q.widget=this;this.Time2=q;if(c.indexOf("T")<0)this.Time2.style.display="none";if(f!=r){error_msg='DateWidget ERROR:  render: menu_set_1 "'+b+'" and menu_set_2 "'+c+'" must both include or both exclude the "Y" flag in the menu_set';throw error_msg;
}}var l;r=document.createElement("table");r.setAttribute("id","DW_table");DW_tbody=document.createElement("tbody");DW_tbody.setAttribute("id","DW_tbody");f=document.createElement("tr");f.setAttribute("id","DW_tr1");l=document.createElement("td");l.setAttribute("id","DW_td1");r.appendChild(DW_tbody);DW_tbody.appendChild(f);f.appendChild(l);if(e.style.display=="none"){l.appendChild(e);l.appendChild(h)}g.style.display=="none"&&l.appendChild(g);j.style.display=="none"&&l.appendChild(j);k.style.display==
"none"&&l.appendChild(k);for(f=0;f<b.length;f++)switch(b.charAt(f)){case "Y":l.appendChild(e);break;case "M":l.appendChild(g);break;case "D":l.appendChild(j);break;case "T":l.appendChild(k);break;default:error_msg='DateWidget ERROR:  render: menu_set "'+b+'" must contain only characters from "YMDT"';throw error_msg;}if(c){h=document.createElement("tr");h.setAttribute("id","DW_tr2");b=document.createElement("td");b.setAttribute("id","DW_td2");DW_tbody.appendChild(h);h.appendChild(b);if(m.style.display==
"none"){b.appendChild(m);b.appendChild(n)}o.style.display=="none"&&b.appendChild(o);p.style.display=="none"&&b.appendChild(p);q.style.display=="none"&&b.appendChild(q);for(f=0;f<c.length;f++)switch(c.charAt(f)){case "Y":b.appendChild(m);break;case "M":b.appendChild(o);break;case "D":b.appendChild(p);break;case "T":b.appendChild(q);break;default:error_msg='DateWidget ERROR:  render: menu_set "'+c+'" must contain only characters from "YMDT"';throw error_msg;}}a.appendChild(r);this.initializeYearMenu(e);
c&&this.initializeYearMenu(m);this.visible=1}
function DateWidget_render(a,b,c){this.element_id=a;this.menu_set_1=b;this.menu_set_2=c;a=document.getElementById(this.element_id);for(var e=a.childNodes,f=e.length-1;f>=0;f--){var g=e[f];g&&a.removeChild(g)}var h,j,k,n,m,o,p,q,r=f=0;if(!b){error_msg='DateWidget ERROR:  render: menu_set_1 must be defined and  must contain only characters from "YMDT"';throw error_msg;}e=document.createElement("select");e.setAttribute("id","DW_Year1");e.widget=this;this.Year1=e;if(b.indexOf("Y")<0){this.Year1.style.display=
"none";this.climatology=f=1;text1=document.createTextNode("Climatology:  ");h=document.createElement("span");h.setAttribute("id","DW_Text1");h.appendChild(text1);h.widget=this;this.Text1=h}g=document.createElement("select");g.setAttribute("id","DW_Month1");g.widget=this;this.Month1=g;if(b.indexOf("M")<0)this.Month1.style.display="none";j=document.createElement("select");j.setAttribute("id","DW_Day1");j.widget=this;this.Day1=j;if(b.indexOf("D")<0)this.Day1.style.display="none";k=document.createElement("select");
k.setAttribute("id","DW_Time1");k.widget=this;this.Time1=k;if(b.indexOf("T")<0)this.Time1.style.display="none";if(c){m=document.createElement("select");m.setAttribute("id","DW_Year2");m.widget=this;this.Year2=m;if(c.indexOf("Y")<0){this.Year2.style.display="none";r=1;text2=document.createTextNode("Climatology:  ");n=document.createElement("span");n.setAttribute("id","DW_Text2");n.appendChild(text2);n.widget=this;this.Text2=n}o=document.createElement("select");o.setAttribute("id","DW_Month2");o.widget=
this;this.Month2=o;if(c.indexOf("M")<0)this.Month2.style.display="none";p=document.createElement("select");p.setAttribute("id","DW_Day2");p.widget=this;this.Day2=p;if(c.indexOf("D")<0)this.Day2.style.display="none";q=document.createElement("select");q.setAttribute("id","DW_Time2");q.widget=this;this.Time2=q;if(c.indexOf("T")<0)this.Time2.style.display="none";if(f!=r){error_msg='DateWidget ERROR:  render: menu_set_1 "'+b+'" and menu_set_2 "'+c+'" must both include or both exclude the "Y" flag in the menu_set';
throw error_msg;}}var l;r=document.createElement("table");r.setAttribute("id","DW_table");DW_tbody=document.createElement("tbody");DW_tbody.setAttribute("id","DW_tbody");f=document.createElement("tr");f.setAttribute("id","DW_tr1");l=document.createElement("td");l.setAttribute("id","DW_td1");r.appendChild(DW_tbody);DW_tbody.appendChild(f);f.appendChild(l);if(e.style.display=="none"){l.appendChild(e);l.appendChild(h)}g.style.display=="none"&&l.appendChild(g);j.style.display=="none"&&l.appendChild(j);
k.style.display=="none"&&l.appendChild(k);for(f=0;f<b.length;f++)switch(b.charAt(f)){case "Y":l.appendChild(e);break;case "M":l.appendChild(g);break;case "D":l.appendChild(j);break;case "T":l.appendChild(k);break;default:error_msg='DateWidget ERROR:  render: menu_set "'+b+'" must contain only characters from "YMDT"';throw error_msg;}if(c){h=document.createElement("tr");h.setAttribute("id","DW_tr2");b=document.createElement("td");b.setAttribute("id","DW_td2");DW_tbody.appendChild(h);h.appendChild(b);
if(m.style.display=="none"){b.appendChild(m);b.appendChild(n)}o.style.display=="none"&&b.appendChild(o);p.style.display=="none"&&b.appendChild(p);q.style.display=="none"&&b.appendChild(q);for(f=0;f<c.length;f++)switch(c.charAt(f)){case "Y":b.appendChild(m);break;case "M":b.appendChild(o);break;case "D":b.appendChild(p);break;case "T":b.appendChild(q);break;default:error_msg='DateWidget ERROR:  render: menu_set "'+c+'" must contain only characters from "YMDT"';throw error_msg;}}a.appendChild(r);this.initializeYearMenu(e);
c&&this.initializeYearMenu(m);this.visible=1}
function DateWidget_initializeYearMenu(a){var b,c,e;if(a.getAttribute("id")=="DW_Year1"){b=this.yearLo;c=this.yearHi;if(this.year1>this.year2){e=this.year2;this.flash(a)}else e=this.year1}else{b=this.yearLo;c=this.yearHi;if(this.year1>this.year2){e=this.year1;this.flash(a)}else e=this.year2}c=c-b+1;var f=b;with(a){for(i=options.length=0;i<c;i++){options[i]=new Option(f,f);f++}if(this.initializing){this.internallyForced=1;if(name=="Year1")options[0].selected=true;else options[length-1].selected=true;
this.initializing=0}else{f=b;for(i=0;i<c;i++){if(f==e)options[i].selected=true;f++}}}a.onchange=this.selectChange;this.selectYear(a)}function DateWidget_setDateRange(a,b,c,e){this.resetDateRange();this.setDate1(a,c);this.setDate2(b,e)}function DateWidget_setDate1(a,b){a=this.parseDate(a,b);this.year1=a[0];this.month1=a[1];this.day1=a[2];this.hour1=a[3];this.minute1=a[4];this.second1=a[5];if(this.climatology)this.Month1&&this.selectMonth(this.Month1);else this.initializeYearMenu(this.Year1)}
function DateWidget_setDate2(a,b){a=this.parseDate(a,b);this.year2=a[0];this.month2=a[1];this.day2=a[2];this.hour2=a[3];this.minute2=a[4];this.second2=a[5];if(this.Year2)this.initializeYearMenu(this.Year2);else this.Month2&&this.selectMonth(this.Month2)}
function DateWidget_toString(){return"dateLo = "+this.getDateLo()+"\ndateHi = "+this.getDateHi()+"\ndate1 = "+this.getDate1()+"\ndate2 = "+this.getDate2()+"\nthis.deltaMinutes = "+this.deltaMinutes+"\nthis.offsetMinutes = "+this.offsetMinutes+"\n"}
function DateWidget_getDateLo(){var a=this.monthLo=="00"?"":"-"+this.monthLo,b=this.dayLo=="00"?"":"-"+this.dayLo,c=this.Time1?" "+this.twoDigit(this.hourLo)+":"+this.twoDigit(this.minuteLo)+":"+this.twoDigit(this.secondLo):"";return this.fourDigit(this.yearLo)+a+b+c}
function DateWidget_getDateHi(){var a=this.monthHi=="00"?"":"-"+this.monthHi,b=this.dayHi=="00"?"":"-"+this.dayHi,c=this.Time2?" "+this.twoDigit(this.hourHi)+":"+this.twoDigit(this.minuteHi)+":"+this.twoDigit(this.secondHi):"";return this.fourDigit(this.yearHi)+a+b+c}
function DateWidget_getDate1(){var a=this.month1=="00"?"":"-"+this.month1,b=this.day1=="00"?"":"-"+this.day1,c=this.Time1?" "+this.twoDigit(this.hour1)+":"+this.twoDigit(this.minute1)+":"+this.twoDigit(this.second1):"";return this.fourDigit(this.year1)+a+b+c}
function DateWidget_getDate2(){var a=this.month2=="00"?"":"-"+this.month2,b=this.day2=="00"?"":"-"+this.day2,c=this.Time2?" "+this.twoDigit(this.hour2)+":"+this.twoDigit(this.minute2)+":"+this.twoDigit(this.second2):"";return this.Year2?this.fourDigit(this.year2)+a+b+c:""}
function DateWidget_getDate1_Ferret(){var a=new Array("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec");a=this.month1=="00"?"":"-"+a[Number(this.month1)-1];var b=this.day1=="00"?"":this.day1,c=this.Time1?" "+this.twoDigit(this.hour1)+":"+this.twoDigit(this.minute1)+":"+this.twoDigit(this.second1):"";return b+a+"-"+this.fourDigit(this.year1)}
function DateWidget_getDate2_Ferret(){var a=new Array("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec");a=this.month2=="00"?"":"-"+a[Number(this.month2)-1];var b=this.day2=="00"?"":this.day2,c=this.Time2?" "+this.twoDigit(this.hour2)+":"+this.twoDigit(this.minute2)+":"+this.twoDigit(this.second2):"";return b+a+"-"+this.fourDigit(this.year2)}function DateWidget_getValue(){var a=this.getDate1_Ferret();if(this.menu_set_2)a=a+","+this.getDate2_Ferret();return a}
function DateWidget_setValue(a,b){b=b?b:1;b==1?this.setDate1(a):this.setDate2(a)}function DateWidget_alert(){alert(this.toString())}function DateWidget_resetDate1(){this.setDate1(this.getDateLo())}function DateWidget_resetDate2(){this.setDate2(this.getDateHi())}function DateWidget_resetDateRange(){this.resetDate1();this.resetDate2()}function DateWidget_setDeltaMinutes(a){this.deltaMinutes=a}function DateWidget_setOffsetMinutes(a){this.offsetMinutes=a}
function DateWidget_disable(a){for(var b=document.getElementById(this.element_id).getElementsByTagName("select"),c=0;c<b.length;c++)switch(a){case "hi":if(b[c].id[b[c].id.length-1]=="2")b[c].disabled=1;else break;case "lo":if(b[c].id[b[c].id.length-1]=="1")b[c].disabled=1;break;default:b[c].disabled=1}this.disabled=1}
function DateWidget_enable(a){for(var b=document.getElementById(this.element_id).getElementsByTagName("select"),c=0;c<b.length;c++)switch(a){case "hi":if(b[c].id[b[c].id.length-1]=="2")b[c].disabled=0;else break;case "lo":if(b[c].id[b[c].id.length-1]=="1")b[c].disabled=0;break;default:b[c].disabled=0}this.disabled=0}function DateWidget_show(){document.getElementById(this.element_id).style.visibility="visible";this.visible=1}
function DateWidget_hide(){document.getElementById(this.element_id).style.visibility="hidden";this.visible=0}function DateWidget_setCallback(a){this.callback=a}
function DateWidget_parseDate(a,b){var c,e=new Date;c=new Date;switch(a){case "NOW":break;case "TODAY":c=new Date;e=new Date(c.getFullYear(),c.getMonth(),c.getDate(),0,0,0);c=new Date(c.getFullYear(),c.getMonth(),c.getDate(),0,0,0);break;default:e=String(a).split(" ");var f=String(e[0]).split("-");c=String(e[0]).split("-");if(String(f[1]).length==3){var g={jan:"01",feb:"02",mar:"03",apr:"04",may:"05",jun:"06",jul:"07",aug:"08",sep:"09",oct:"10",nov:"11",dec:"12"}[String(f[1].toLowerCase())];c[0]=
f[2]?f[2]:"0001";c[1]=g;c[2]=f[0]}if(c[0]){if(Number(c[0]).valueOf()>=8E3){b='The DateWidget cannot handle years >= 8000.  Incoming date is "'+a+'"';throw b;}a=Number(c[0]).valueOf();if(a<100){a+=8E3;c[0]=String(a)}a=Number(c[0]);(new Date(a,1,1)).getFullYear()}if(e[1]){a=String(e[1]).split(":");c[3]=a[0];c[4]=a[1];c[5]=a[2]}else{c[3]="00";c[4]="00";c[5]="00"}if(Number(c[1]).valueOf()<1||Number(c[1]).valueOf()>12){b='DateWidget ERROR:  parseDate:  month "'+c[1]+'" must be in the range 1:12';throw b;
}if(Number(c[2]).valueOf()<1||Number(c[2]).valueOf()>31){b='DateWidget ERROR:  parseDate:  day "'+c[2]+'" must be in the range 1:31';throw b;}if(Number(c[3]).valueOf()<0||Number(c[3]).valueOf()>23){b='DateWidget ERROR:  parseDate:  hour "'+c[3]+'" must be in the range 0:23';throw b;}if(Number(c[4]).valueOf()<0||Number(c[4]).valueOf()>59){b='DateWidget ERROR:  parseDate:  minute "'+c[4]+'" must be in the range 0:59';throw b;}if(Number(c[5]).valueOf()<0||Number(c[5]).valueOf()>59){b='DateWidget ERROR:  parseDate:  second "'+
c[5]+'" must be in the range 0:59';throw b;}e=new Date(c[0],c[1]-1,c[2],c[3],c[4],c[5]);c=new Date(c[0],c[1]-1,c[2],c[3],c[4],c[5]);break}if(b){b=e.valueOf()+6E4*b;c=new Date(b)}with(c)c=new Array(getFullYear(),getMonth()+1,getDate(),getHours(),getMinutes(),getSeconds());c[5]=0;if(c[0]>=8E3)c[0]-=8E3;return c}function DateWidget_febDays(a){var b=28;if(a%4==0){b=29;if(a%100==0){b=28;if(a%400==0)b=29}}return b}function DateWidget_twoDigit(a){if(String(a).length==1)a="0"+String(a);return a}
function DateWidget_fourDigit(a){for(;String(a).length<4;)a="0"+String(a);return a}function DateWidget_correctOrder(){var a=1;if(this.year1>this.year2)a=0;else if(this.year1==this.year2)if(this.month1>this.month2)a=0;else if(this.month1==this.month2)if(this.day1>this.day2)a=0;else if(this.day1==this.day2)if(this.hour1>this.hour2)a=0;return a}
function DateWidget_addEvent(a,b,c,e){if(a.addEventListener){a.addEventListener(b,c,e);return true}else if(a.attachEvent)return a.attachEvent("on"+b,c);else a["on"+b]=c}function DateWidget_flash(a){var b="document.getElementById('"+a.id+"').style.backgroundColor = '#fff'";a.style.backgroundColor="#fcc";window.setTimeout(b,750)}
function DateWidget_selectYear(a){var b=new Array("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"),c=new Array("01","02","03","04","05","06","07","08","09","10","11","12");currentYear=a.options[a.selectedIndex].value;var e,f;if(a.getAttribute("id")=="DW_Year1"){f=this.Month1;this.year1=currentYear;if(this.year1==this.year2&&this.month1>this.month2){e=this.month2-1;this.flash(f)}else e=this.month1-1}else{f=this.Month2;this.year2=currentYear;if(this.year1==this.year2&&this.month1>
this.month2){e=this.month1-1;this.flash(f)}else e=this.month2-1}var g=0,h=11;a=a.getAttribute("id")=="DW_Year1"?this.Year2:this.Year1;if(currentYear==this.yearLo)g=this.monthLo-1;if(currentYear==this.yearHi)h=this.monthHi-1;if(f){with(f){a=h-g;var j=g;options.length=0;if(this.monthLo!="00"){for(k=0;k<=a;k++){options[k]=new Option(b[j],c[j]);j++}if(e<g||e>h)if(e<g)options[0].selected=true;else{var k=h-g;if(options[k])options[k].selected=true}else{k=e-g;if(options[k])options[k].selected=true}}}f.onchange=
this.selectChange;this.selectMonth(f)}else if(this.internallyForced)this.internallyForced=0;else if(a)if(!this.correctOrder()){this.internallyForced=1;this.initializeYearMenu(a)}}
function DateWidget_selectMonth(a){var b,c,e,f,g,h=new Array("01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31");c=this.monthLo=="00"?"00":a.options[a.selectedIndex].value;if(a.getAttribute("id")=="DW_Month1"){g=this.Year2;f=this.Day1;b=this.year1;this.month1=c;if(this.year1==this.year2&&this.month1==this.month2&&this.day1>this.day2){e=this.day2;this.flash(f)}else e=this.day1}else{g=this.Year1;
f=this.Day2;b=this.year2;this.month2=c;if(this.year1==this.year2&&this.month1==this.month2&&this.day1>this.day2){e=this.day1;this.flash(f)}else e=this.day2}var j=1,k=31;switch(c){case "02":k=this.febDays(b);break;case "04":k=30;break;case "06":k=30;break;case "09":k=30;break;case "11":k=30;break;default:k=31;break}a.getAttribute("id");if(b==this.yearLo&&c==this.monthLo)j=this.dayLo;if(b==this.yearHi&&c==this.monthHi)k=this.dayHi;if(f){with(f){a=k-j+1;b=j-1;options.length=0;if(this.dayLo!="00"){for(c=
0;c<a;c++){options[c]=new Option(h[b],h[b]);b++}if(e<j||e>k){if(e<j)options[0].selected=true;else{c=k-j;options[c].selected=true}this.flash(f)}else{c=e-j;options[c].selected=true}}}f.onchange=this.selectChange;this.selectDay(f)}else if(this.internallyForced)this.internallyForced=0;else if(g)if(!this.correctOrder()){this.internallyForced=1;this.initializeYearMenu(g)}}
function DateWidget_selectDay(a){var b,c,e,f;e=this.dayLo=="00"?"00":a.options[a.selectedIndex].value;if(a.getAttribute("id")=="DW_Day1"){this.day1=e;a=this.Time1;f=this.Year2;b=this.year1;c=this.month1;e=this.day1;currentTime=this.hour1+":"+this.minute1}else{this.day2=e;a=this.Time2;f=this.Year1;b=this.year2;c=this.month2;e=this.day2;currentTime=this.hour2+":"+this.minute2}var g=this.offsetMinutes,h=1440;if(b==this.yearLo&&c==this.monthLo&&e==this.dayLo)g=Number(this.minuteLo)+Number(this.hourLo)*
60;if(b==this.yearHi&&c==this.monthHi&&e==this.dayHi)h=Number(this.minuteHi)+Number(this.hourHi)*60;if(a){with(a){var j="00:00";e=Math.floor(g/60);b=g-e*60;c=g;g=Math.floor((h-g)/this.deltaMinutes)+1;for(i=0;i<g;i++){j=this.twoDigit(e)+":"+this.twoDigit(b);options[i]=new Option(j,j);h=String(currentTime).split(":");if(h[0]==e&&h[1]==b)options[i].selected=true;c=Number(c)+Number(this.deltaMinutes);e=Math.floor(c/60);b=c-e*60;if(e>=24)break}}a.onchange=this.selectChange}if(this.internallyForced)this.internallyForced=
0;else if(f)if(!this.correctOrder()){this.internallyForced=1;this.initializeYearMenu(f)}}function DateWidget_selectTime(a){var b=String(a.options[a.selectedIndex].value).split(":");if(a.getAttribute("id")=="DW_Time1"){this.hour1=b[0];this.minute1=b[1]}else{this.hour2=b[0];this.minute2=b[1]}}
function DateWidget_selectChange(a){if(window.event&&window.event.srcElement)a=window.event.srcElement;else if(a&&a.target)a=a.target;else{alert("DateWidget ERROR:\n> selectChange:  This browser does not support standard javascript events.");return}if(a.nodeName.toLowerCase()!="select")alert("DateWidget ERROR:\n> selectChange:  event target ["+a.nodeName.toLowerCase()+"] should instead be [select]");else{a=a;var b=a.widget;switch(a.getAttribute("id")){case "DW_Year1":b.selectYear(a);break;case "DW_Month1":b.selectMonth(a);
break;case "DW_Day1":b.selectDay(a);break;case "DW_Time1":b.selectTime(a);break;case "DW_Year2":b.selectYear(a);break;case "DW_Month2":b.selectMonth(a);break;case "DW_Day2":b.selectDay(a);break;case "DW_Time2":b.selectTime(a);break}b.callback&&b.callback(b)}};
